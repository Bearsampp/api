<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.14.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Bearsampp: Vbs Class Reference</title>
<link rel="icon" href="../../Bearsampp-orange-logo-for-bearsampp-sandbox-32x32.png" type="image/x-icon" />
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<script type="text/javascript" src="../../clipboard.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript" src="../../cookie.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="../../header-logo.png"/></td>
  <td id="projectalign">
   <div id="projectname">Bearsampp<span id="projectnumber">&#160;2025.8.29</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.14.0 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('../../',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(function(){initNavTree('d5/dbc/class_vbs.html','../../',''); });
</script>
<div id="container">
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">Vbs Class Reference</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-pub-methods" class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a095c5d389db211932136b53f25f39685" id="r_a095c5d389db211932136b53f25f39685"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a095c5d389db211932136b53f25f39685">__construct</a> ()</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-pub-static-methods" class="groupheader"><a id="pub-static-methods" name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:a881ab318419acf17f1e26dab1de1a19d" id="r_a881ab318419acf17f1e26dab1de1a19d"><td class="memItemLeft" align="right" valign="top">static&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a881ab318419acf17f1e26dab1de1a19d">countFilesFolders</a> ($path)</td></tr>
<tr class="memitem:a486b0eb0eacdd2766e62e969b77b7b9d" id="r_a486b0eb0eacdd2766e62e969b77b7b9d"><td class="memItemLeft" align="right" valign="top">static&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a486b0eb0eacdd2766e62e969b77b7b9d">createShortcut</a> ($savePath)</td></tr>
<tr class="memitem:a5be68e999bf31b7f671054c54565b6a1" id="r_a5be68e999bf31b7f671054c54565b6a1"><td class="memItemLeft" align="right" valign="top">static&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a5be68e999bf31b7f671054c54565b6a1">exec</a> ($basename, $resultFile, $content, $timeout=true)</td></tr>
<tr class="memitem:a3cd75e2b339fe9e96ab0bd481a35d612" id="r_a3cd75e2b339fe9e96ab0bd481a35d612"><td class="memItemLeft" align="right" valign="top">static&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a3cd75e2b339fe9e96ab0bd481a35d612">getDefaultBrowser</a> ()</td></tr>
<tr class="memitem:a51101c75bfdf7cdce10de2a1d1fc6ffc" id="r_a51101c75bfdf7cdce10de2a1d1fc6ffc"><td class="memItemLeft" align="right" valign="top">static&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a51101c75bfdf7cdce10de2a1d1fc6ffc">getInstalledBrowsers</a> ()</td></tr>
<tr class="memitem:afaafe73f99805f4c5d9fbeea9a36e5cf" id="r_afaafe73f99805f4c5d9fbeea9a36e5cf"><td class="memItemLeft" align="right" valign="top">static&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#afaafe73f99805f4c5d9fbeea9a36e5cf">getListProcs</a> ($vbsKeys)</td></tr>
<tr class="memitem:a2790ba3876c9f7f66ebec833eea82a2b" id="r_a2790ba3876c9f7f66ebec833eea82a2b"><td class="memItemLeft" align="right" valign="top">static&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a2790ba3876c9f7f66ebec833eea82a2b">getResultFile</a> ($basename)</td></tr>
<tr class="memitem:a37812a8038eddfce6bb5a756af87935a" id="r_a37812a8038eddfce6bb5a756af87935a"><td class="memItemLeft" align="right" valign="top">static&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a37812a8038eddfce6bb5a756af87935a">getServiceInfos</a> ($serviceName)</td></tr>
<tr class="memitem:afa896a018142f4d91a29b1cf67dbf51d" id="r_afa896a018142f4d91a29b1cf67dbf51d"><td class="memItemLeft" align="right" valign="top">static&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#afa896a018142f4d91a29b1cf67dbf51d">getStartupPath</a> ($file=null)</td></tr>
<tr class="memitem:ac83f11b6ccf65f89682e269e9528a492" id="r_ac83f11b6ccf65f89682e269e9528a492"><td class="memItemLeft" align="right" valign="top">static&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac83f11b6ccf65f89682e269e9528a492">getTmpFile</a> ($ext, $customName=null)</td></tr>
<tr class="memitem:aebc14ecd472e0982e772d53f02ffe220" id="r_aebc14ecd472e0982e772d53f02ffe220"><td class="memItemLeft" align="right" valign="top">static&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aebc14ecd472e0982e772d53f02ffe220">killProc</a> ($pid)</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-pub-attribs" class="groupheader"><a id="pub-attribs" name="pub-attribs"></a>
Data Fields</h2></td></tr>
<tr class="memitem:a56575463227295c2eb9e96538e874207" id="r_a56575463227295c2eb9e96538e874207"><td class="memItemLeft" align="right" valign="top">const&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a56575463227295c2eb9e96538e874207">ALL_DESKTOP_PATH</a> = 'objShell.SpecialFolders(&quot;AllUsersDesktop&quot;)'</td></tr>
<tr class="memitem:ac13ae1a5af3c69138feec1408ac983e2" id="r_ac13ae1a5af3c69138feec1408ac983e2"><td class="memItemLeft" align="right" valign="top">const&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac13ae1a5af3c69138feec1408ac983e2">ALL_STARTUP_PATH</a> = 'objShell.SpecialFolders(&quot;AllUsersStartup&quot;)'</td></tr>
<tr class="memitem:a8b5fceba526639344aec54e33c9fe838" id="r_a8b5fceba526639344aec54e33c9fe838"><td class="memItemLeft" align="right" valign="top">const&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a8b5fceba526639344aec54e33c9fe838">DESKTOP_PATH</a> = 'objShell.SpecialFolders(&quot;Desktop&quot;)'</td></tr>
<tr class="memitem:af5b7c5485cc0fb57776174544fed2823" id="r_af5b7c5485cc0fb57776174544fed2823"><td class="memItemLeft" align="right" valign="top">const&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af5b7c5485cc0fb57776174544fed2823">END_PROCESS_STR</a> = 'FINISHED!'</td></tr>
<tr class="memitem:a54192de84d35d097a2d1ec81e5a2c704" id="r_a54192de84d35d097a2d1ec81e5a2c704"><td class="memItemLeft" align="right" valign="top">const&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a54192de84d35d097a2d1ec81e5a2c704">STARTUP_PATH</a> = 'objShell.SpecialFolders(&quot;Startup&quot;)'</td></tr>
<tr class="memitem:abcd066e2ac9191bca4dff9f4b39960c3" id="r_abcd066e2ac9191bca4dff9f4b39960c3"><td class="memItemLeft" align="right" valign="top">const&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#abcd066e2ac9191bca4dff9f4b39960c3">STR_SEPARATOR</a> = ' || '</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-pri-static-methods" class="groupheader"><a id="pri-static-methods" name="pri-static-methods"></a>
Static Private Member Functions</h2></td></tr>
<tr class="memitem:a53925cff6048273f90461d3bc6aa4ac5" id="r_a53925cff6048273f90461d3bc6aa4ac5"><td class="memItemLeft" align="right" valign="top">static&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a53925cff6048273f90461d3bc6aa4ac5">getSpecialPath</a> ($path)</td></tr>
<tr class="memitem:a1e3715665ded5e5e73e20916e669da29" id="r_a1e3715665ded5e5e73e20916e669da29"><td class="memItemLeft" align="right" valign="top">static&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1e3715665ded5e5e73e20916e669da29">writeLog</a> ($log)</td></tr>
</table>
<a name="details" id="details"></a><h2 id="header-details" class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Class <a class="el" href="../../d5/dbc/class_vbs.html">Vbs</a></p>
<p>This class provides various utility functions for interacting with the Windows operating system using VBScript. It includes methods for counting files and folders, retrieving default and installed browsers, managing processes, and creating shortcuts. </p>

<p class="definition">Definition at line <a class="el" href="../../d8/d62/class_8vbs_8php_source.html#l00018">18</a> of file <a class="el" href="../../d8/d62/class_8vbs_8php_source.html">class.vbs.php</a>.</p>
</div><a name="doc-constructors" id="doc-constructors"></a><h2 id="header-doc-constructors" class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a095c5d389db211932136b53f25f39685" name="a095c5d389db211932136b53f25f39685"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a095c5d389db211932136b53f25f39685">&#9670;&#160;</a></span>__construct()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__construct </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/d62/class_8vbs_8php_source.html#l00028">28</a> of file <a class="el" href="../../d8/d62/class_8vbs_8php_source.html">class.vbs.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   29</span>    {</div>
<div class="line"><span class="lineno">   30</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a name="doc-func-members" id="doc-func-members"></a><h2 id="header-doc-func-members" class="groupheader">Member Function Documentation</h2>
<a id="a881ab318419acf17f1e26dab1de1a19d" name="a881ab318419acf17f1e26dab1de1a19d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a881ab318419acf17f1e26dab1de1a19d">&#9670;&#160;</a></span>countFilesFolders()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">countFilesFolders </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$path</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Counts the number of files and folders in the specified path.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$path</td><td>The path to count files and folders in.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>int|false The count of files and folders, or false on failure. </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d8/d62/class_8vbs_8php_source.html#l00050">50</a> of file <a class="el" href="../../d8/d62/class_8vbs_8php_source.html">class.vbs.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   51</span>    {</div>
<div class="line"><span class="lineno">   52</span>        $basename   = <span class="stringliteral">&#39;countFilesFolders&#39;</span>;</div>
<div class="line"><span class="lineno">   53</span>        $resultFile = <a class="code hl_function" href="#a2790ba3876c9f7f66ebec833eea82a2b">self::getResultFile</a>( $basename );</div>
<div class="line"><span class="lineno">   54</span> </div>
<div class="line"><span class="lineno">   55</span>        $content = <span class="stringliteral">&#39;Dim objFso, objResultFile, objCheckFile&#39;</span> . PHP_EOL . PHP_EOL;</div>
<div class="line"><span class="lineno">   56</span>        $content .= <span class="stringliteral">&#39;Set objFso = CreateObject(&quot;scripting.filesystemobject&quot;)&#39;</span> . PHP_EOL;</div>
<div class="line"><span class="lineno">   57</span>        $content .= <span class="stringliteral">&#39;Set objResultFile = objFso.CreateTextFile(&quot;&#39;</span> . $resultFile . <span class="stringliteral">&#39;&quot;, True)&#39;</span> . PHP_EOL;</div>
<div class="line"><span class="lineno">   58</span>        $content .= <span class="stringliteral">&#39;count = 0&#39;</span> . PHP_EOL;</div>
<div class="line"><span class="lineno">   59</span>        $content .= <span class="stringliteral">&#39;CountFiles(&quot;&#39;</span> . $path . <span class="stringliteral">&#39;&quot;)&#39;</span> . PHP_EOL . PHP_EOL;</div>
<div class="line"><span class="lineno">   60</span>        $content .= <span class="stringliteral">&#39;Function CountFiles(ByVal path)&#39;</span> . PHP_EOL;</div>
<div class="line"><span class="lineno">   61</span>        $content .= <span class="stringliteral">&#39;    Dim parentFld, subFld&#39;</span> . PHP_EOL;</div>
<div class="line"><span class="lineno">   62</span>        $content .= <span class="stringliteral">&#39;    Set parentFld = objFso.GetFolder(path)&#39;</span> . PHP_EOL . PHP_EOL;</div>
<div class="line"><span class="lineno">   63</span>        $content .= <span class="stringliteral">&#39;    count = count + parentFld.Files.Count + parentFld.SubFolders.Count&#39;</span> . PHP_EOL;</div>
<div class="line"><span class="lineno">   64</span>        $content .= <span class="stringliteral">&#39;    For Each subFld In parentFld.SubFolders&#39;</span> . PHP_EOL;</div>
<div class="line"><span class="lineno">   65</span>        $content .= <span class="stringliteral">&#39;        count = count + CountFiles(subFld.Path)&#39;</span> . PHP_EOL;</div>
<div class="line"><span class="lineno">   66</span>        $content .= <span class="stringliteral">&#39;    Next&#39;</span> . PHP_EOL . PHP_EOL;</div>
<div class="line"><span class="lineno">   67</span>        $content .= <span class="stringliteral">&#39;End Function&#39;</span> . PHP_EOL . PHP_EOL;</div>
<div class="line"><span class="lineno">   68</span>        $content .= <span class="stringliteral">&#39;objResultFile.Write count&#39;</span> . PHP_EOL;</div>
<div class="line"><span class="lineno">   69</span>        $content .= <span class="stringliteral">&#39;objResultFile.Close&#39;</span> . PHP_EOL;</div>
<div class="line"><span class="lineno">   70</span> </div>
<div class="line"><span class="lineno">   71</span>        <a class="code hl_variable" href="../../d4/d44/ajax_8apache_8php.html#a112ef069ddc0454086e3d1e6d8d55d07">$result</a> = <a class="code hl_function" href="#a5be68e999bf31b7f671054c54565b6a1">self::exec</a>( $basename, $resultFile, $content );</div>
<div class="line"><span class="lineno">   72</span> </div>
<div class="line"><span class="lineno">   73</span>        <span class="keywordflow">return</span> isset( <a class="code hl_variable" href="../../d4/d44/ajax_8apache_8php.html#a112ef069ddc0454086e3d1e6d8d55d07">$result</a>[0] ) &amp;&amp; is_numeric( <a class="code hl_variable" href="../../d4/d44/ajax_8apache_8php.html#a112ef069ddc0454086e3d1e6d8d55d07">$result</a>[0] ) ? intval( <a class="code hl_variable" href="../../d4/d44/ajax_8apache_8php.html#a112ef069ddc0454086e3d1e6d8d55d07">$result</a>[0] ) : false;</div>
<div class="line"><span class="lineno">   74</span>    }</div>
<div class="ttc" id="aajax_8apache_8php_html_a112ef069ddc0454086e3d1e6d8d55d07"><div class="ttname"><a href="../../d4/d44/ajax_8apache_8php.html#a112ef069ddc0454086e3d1e6d8d55d07">$result</a></div><div class="ttdeci">$result</div><div class="ttdef"><b>Definition</b> <a href="../../d4/d44/ajax_8apache_8php_source.html#l00019">ajax.apache.php:19</a></div></div>
<div class="ttc" id="aclass_vbs_html_a2790ba3876c9f7f66ebec833eea82a2b"><div class="ttname"><a href="#a2790ba3876c9f7f66ebec833eea82a2b">Vbs\getResultFile</a></div><div class="ttdeci">static getResultFile($basename)</div><div class="ttdef"><b>Definition</b> <a href="../../d8/d62/class_8vbs_8php_source.html#l00424">class.vbs.php:424</a></div></div>
<div class="ttc" id="aclass_vbs_html_a5be68e999bf31b7f671054c54565b6a1"><div class="ttname"><a href="#a5be68e999bf31b7f671054c54565b6a1">Vbs\exec</a></div><div class="ttdeci">static exec($basename, $resultFile, $content, $timeout=true)</div><div class="ttdef"><b>Definition</b> <a href="../../d8/d62/class_8vbs_8php_source.html#l00439">class.vbs.php:439</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d4/d44/ajax_8apache_8php_source.html#l00019">$result</a>, <a class="el" href="../../d8/d62/class_8vbs_8php_source.html#l00439">exec()</a>, and <a class="el" href="../../d8/d62/class_8vbs_8php_source.html#l00424">getResultFile()</a>.</p>

</div>
</div>
<a id="a486b0eb0eacdd2766e62e969b77b7b9d" name="a486b0eb0eacdd2766e62e969b77b7b9d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a486b0eb0eacdd2766e62e969b77b7b9d">&#9670;&#160;</a></span>createShortcut()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">createShortcut </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$savePath</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Creates a shortcut to the <a class="el" href="../../da/deb/namespace_bearsampp.html">Bearsampp</a> executable.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$savePath</td><td>The path to save the shortcut.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>bool True on success, false on failure. </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d8/d62/class_8vbs_8php_source.html#l00314">314</a> of file <a class="el" href="../../d8/d62/class_8vbs_8php_source.html">class.vbs.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  315</span>    {</div>
<div class="line"><span class="lineno">  316</span>        global <a class="code hl_variable" href="../../d4/d44/ajax_8apache_8php.html#a9f1773c8b2e8f420b90fe4cce25ff9cf">$bearsamppRoot</a>, <a class="code hl_variable" href="../../da/dd5/ajax_8latestversion_8php.html#adbfa2152f4bc29f5de1967eb55b09198">$bearsamppCore</a>;</div>
<div class="line"><span class="lineno">  317</span>        $basename   = <span class="stringliteral">&#39;createShortcut&#39;</span>;</div>
<div class="line"><span class="lineno">  318</span>        $resultFile = <a class="code hl_function" href="#a2790ba3876c9f7f66ebec833eea82a2b">self::getResultFile</a>( $basename );</div>
<div class="line"><span class="lineno">  319</span> </div>
<div class="line"><span class="lineno">  320</span>        $content = <span class="stringliteral">&#39;Dim objShell, objFso, objResultFile&#39;</span> . PHP_EOL . PHP_EOL;</div>
<div class="line"><span class="lineno">  321</span>        $content .= <span class="stringliteral">&#39;Set objShell = Wscript.CreateObject(&quot;Wscript.Shell&quot;)&#39;</span> . PHP_EOL;</div>
<div class="line"><span class="lineno">  322</span>        $content .= <span class="stringliteral">&#39;Set objFso = CreateObject(&quot;scripting.filesystemobject&quot;)&#39;</span> . PHP_EOL;</div>
<div class="line"><span class="lineno">  323</span>        $content .= <span class="stringliteral">&#39;Set objResultFile = objFso.CreateTextFile(&quot;&#39;</span> . $resultFile . <span class="stringliteral">&#39;&quot;, True)&#39;</span> . PHP_EOL . PHP_EOL;</div>
<div class="line"><span class="lineno">  324</span>        $content .= <span class="stringliteral">&#39;Set objShortcut = objShell.CreateShortcut(&quot;&#39;</span> . $savePath . <span class="stringliteral">&#39;&quot;)&#39;</span> . PHP_EOL;</div>
<div class="line"><span class="lineno">  325</span>        $content .= <span class="stringliteral">&#39;objShortCut.TargetPath = &quot;&#39;</span> . <a class="code hl_variable" href="../../d4/d44/ajax_8apache_8php.html#a9f1773c8b2e8f420b90fe4cce25ff9cf">$bearsamppRoot</a>-&gt;getExeFilePath() . <span class="charliteral">&#39;&quot;&#39;</span> . PHP_EOL;</div>
<div class="line"><span class="lineno">  326</span>        $content .= <span class="stringliteral">&#39;objShortCut.WorkingDirectory = &quot;&#39;</span> . <a class="code hl_variable" href="../../d4/d44/ajax_8apache_8php.html#a9f1773c8b2e8f420b90fe4cce25ff9cf">$bearsamppRoot</a>-&gt;getRootPath() . <span class="charliteral">&#39;&quot;&#39;</span> . PHP_EOL;</div>
<div class="line"><span class="lineno">  327</span>        $content .= <span class="stringliteral">&#39;objShortCut.Description = &quot;&#39;</span> . <a class="code hl_variable" href="../../d7/de1/root_8php.html#af76956a6aeffa052e53bbcc9b2afb3df">APP_TITLE</a> . <span class="charliteral">&#39; &#39;</span> . <a class="code hl_variable" href="../../da/dd5/ajax_8latestversion_8php.html#adbfa2152f4bc29f5de1967eb55b09198">$bearsamppCore</a>-&gt;getAppVersion() . <span class="charliteral">&#39;&quot;&#39;</span> . PHP_EOL;</div>
<div class="line"><span class="lineno">  328</span>        $content .= <span class="stringliteral">&#39;objShortCut.IconLocation = &quot;&#39;</span> . <a class="code hl_variable" href="../../da/dd5/ajax_8latestversion_8php.html#adbfa2152f4bc29f5de1967eb55b09198">$bearsamppCore</a>-&gt;getIconsPath() . <span class="stringliteral">&#39;/app.ico&#39;</span> . <span class="charliteral">&#39;&quot;&#39;</span> . PHP_EOL;</div>
<div class="line"><span class="lineno">  329</span>        $content .= <span class="stringliteral">&#39;objShortCut.Save&#39;</span> . PHP_EOL;</div>
<div class="line"><span class="lineno">  330</span>        $content .= <span class="stringliteral">&#39;If Err.Number &lt;&gt; 0 Then&#39;</span> . PHP_EOL;</div>
<div class="line"><span class="lineno">  331</span>        $content .= <span class="stringliteral">&#39;    objResultFile.Write Err.Number &amp; &quot;: &quot; &amp; Err.Description&#39;</span> . PHP_EOL;</div>
<div class="line"><span class="lineno">  332</span>        $content .= <span class="stringliteral">&#39;End If&#39;</span> . PHP_EOL;</div>
<div class="line"><span class="lineno">  333</span>        $content .= <span class="stringliteral">&#39;objResultFile.Close&#39;</span> . PHP_EOL;</div>
<div class="line"><span class="lineno">  334</span> </div>
<div class="line"><span class="lineno">  335</span>        <a class="code hl_variable" href="../../d4/d44/ajax_8apache_8php.html#a112ef069ddc0454086e3d1e6d8d55d07">$result</a> = <a class="code hl_function" href="#a5be68e999bf31b7f671054c54565b6a1">self::exec</a>( $basename, $resultFile, $content );</div>
<div class="line"><span class="lineno">  336</span>        <span class="keywordflow">if</span> ( empty( <a class="code hl_variable" href="../../d4/d44/ajax_8apache_8php.html#a112ef069ddc0454086e3d1e6d8d55d07">$result</a> ) ) {</div>
<div class="line"><span class="lineno">  337</span>            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  338</span>        }</div>
<div class="line"><span class="lineno">  339</span>        elseif ( isset( <a class="code hl_variable" href="../../d4/d44/ajax_8apache_8php.html#a112ef069ddc0454086e3d1e6d8d55d07">$result</a>[0] ) ) {</div>
<div class="line"><span class="lineno">  340</span>            <a class="code hl_function" href="../../d1/d0a/class_util.html#a05d384b2e8414a0c833d6ce561007e62">Util::logError</a>( <span class="stringliteral">&#39;createShortcut: &#39;</span> . <a class="code hl_variable" href="../../d4/d44/ajax_8apache_8php.html#a112ef069ddc0454086e3d1e6d8d55d07">$result</a>[0] );</div>
<div class="line"><span class="lineno">  341</span> </div>
<div class="line"><span class="lineno">  342</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  343</span>        }</div>
<div class="line"><span class="lineno">  344</span> </div>
<div class="line"><span class="lineno">  345</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  346</span>    }</div>
<div class="ttc" id="aajax_8apache_8php_html_a9f1773c8b2e8f420b90fe4cce25ff9cf"><div class="ttname"><a href="../../d4/d44/ajax_8apache_8php.html#a9f1773c8b2e8f420b90fe4cce25ff9cf">$bearsamppRoot</a></div><div class="ttdeci">global $bearsamppRoot</div><div class="ttdef"><b>Definition</b> <a href="../../d4/d44/ajax_8apache_8php_source.html#l00016">ajax.apache.php:16</a></div></div>
<div class="ttc" id="aajax_8latestversion_8php_html_adbfa2152f4bc29f5de1967eb55b09198"><div class="ttname"><a href="../../da/dd5/ajax_8latestversion_8php.html#adbfa2152f4bc29f5de1967eb55b09198">$bearsamppCore</a></div><div class="ttdeci">global $bearsamppCore</div><div class="ttdef"><b>Definition</b> <a href="../../da/dd5/ajax_8latestversion_8php_source.html#l00024">ajax.latestversion.php:24</a></div></div>
<div class="ttc" id="aclass_util_html_a05d384b2e8414a0c833d6ce561007e62"><div class="ttname"><a href="../../d1/d0a/class_util.html#a05d384b2e8414a0c833d6ce561007e62">Util\logError</a></div><div class="ttdeci">static logError($data, $file=null)</div><div class="ttdef"><b>Definition</b> <a href="../../d5/d12/class_8util_8php_source.html#l00791">class.util.php:791</a></div></div>
<div class="ttc" id="aroot_8php_html_af76956a6aeffa052e53bbcc9b2afb3df"><div class="ttname"><a href="../../d7/de1/root_8php.html#af76956a6aeffa052e53bbcc9b2afb3df">APP_TITLE</a></div><div class="ttdeci">const APP_TITLE</div><div class="ttdef"><b>Definition</b> <a href="../../d7/de1/root_8php_source.html#l00013">root.php:13</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../da/dd5/ajax_8latestversion_8php_source.html#l00024">$bearsamppCore</a>, <a class="el" href="../../d4/d44/ajax_8apache_8php_source.html#l00016">$bearsamppRoot</a>, <a class="el" href="../../d4/d44/ajax_8apache_8php_source.html#l00019">$result</a>, <a class="el" href="../../d7/de1/root_8php_source.html#l00013">APP_TITLE</a>, <a class="el" href="../../d8/d62/class_8vbs_8php_source.html#l00439">exec()</a>, <a class="el" href="../../d8/d62/class_8vbs_8php_source.html#l00424">getResultFile()</a>, and <a class="el" href="../../d5/d12/class_8util_8php_source.html#l00791">Util\logError()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/d12/class_8util_8php_source.html#l00639">Util\enableLaunchStartup()</a>.</p>

</div>
</div>
<a id="a5be68e999bf31b7f671054c54565b6a1" name="a5be68e999bf31b7f671054c54565b6a1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5be68e999bf31b7f671054c54565b6a1">&#9670;&#160;</a></span>exec()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">exec </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$basename</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$resultFile</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$content</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$timeout</em></span><span class="paramdefsep"> = </span><span class="paramdefval">true</span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Executes a VBScript file and retrieves the result.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$basename</td><td>The base name for the script and result files. </td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$resultFile</td><td>The path to the result file. </td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$content</td><td>The VBScript content to execute. </td></tr>
    <tr><td class="paramtype">int&#160;|&#160;bool</td><td class="paramname">$timeout</td><td>The timeout duration in seconds, or true for default timeout, or false for no timeout.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>array|false The result of the script execution as an array of lines, or false on failure. </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d8/d62/class_8vbs_8php_source.html#l00439">439</a> of file <a class="el" href="../../d8/d62/class_8vbs_8php_source.html">class.vbs.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  440</span>    {</div>
<div class="line"><span class="lineno">  441</span>        global <a class="code hl_variable" href="../../d9/dbf/homepage_8php.html#a51fdddae876fe5f26d09f816e6612414">$bearsamppConfig</a>, $bearsamppWinbinder;</div>
<div class="line"><span class="lineno">  442</span>        <a class="code hl_variable" href="../../d4/d44/ajax_8apache_8php.html#a112ef069ddc0454086e3d1e6d8d55d07">$result</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  443</span> </div>
<div class="line"><span class="lineno">  444</span>        $scriptPath       = <a class="code hl_function" href="#ac83f11b6ccf65f89682e269e9528a492">self::getTmpFile</a>( <span class="stringliteral">&#39;.vbs&#39;</span>, $basename );</div>
<div class="line"><span class="lineno">  445</span>        $checkFile        = <a class="code hl_function" href="#ac83f11b6ccf65f89682e269e9528a492">self::getTmpFile</a>( <span class="stringliteral">&#39;.tmp&#39;</span>, $basename );</div>
<div class="line"><span class="lineno">  446</span>        $errFile          = <a class="code hl_function" href="#ac83f11b6ccf65f89682e269e9528a492">self::getTmpFile</a>( <span class="stringliteral">&#39;.tmp&#39;</span>, $basename );</div>
<div class="line"><span class="lineno">  447</span>        $randomVarName    = <a class="code hl_function" href="../../d1/d0a/class_util.html#a8947bb42d36178ac24f7f2168cdf7230">Util::random</a>( 15, <span class="keyword">false</span> );</div>
<div class="line"><span class="lineno">  448</span>        $randomObjErrFile = <a class="code hl_function" href="../../d1/d0a/class_util.html#a8947bb42d36178ac24f7f2168cdf7230">Util::random</a>( 15, <span class="keyword">false</span> );</div>
<div class="line"><span class="lineno">  449</span>        $randomObjFile    = <a class="code hl_function" href="../../d1/d0a/class_util.html#a8947bb42d36178ac24f7f2168cdf7230">Util::random</a>( 15, <span class="keyword">false</span> );</div>
<div class="line"><span class="lineno">  450</span>        $randomObjFso     = <a class="code hl_function" href="../../d1/d0a/class_util.html#a8947bb42d36178ac24f7f2168cdf7230">Util::random</a>( 15, <span class="keyword">false</span> );</div>
<div class="line"><span class="lineno">  451</span> </div>
<div class="line"><span class="lineno">  452</span>        <span class="comment">// Add a timeout to the VBScript itself</span></div>
<div class="line"><span class="lineno">  453</span>        $timeoutSeconds = 10; <span class="comment">// 10 seconds timeout for the VBScript</span></div>
<div class="line"><span class="lineno">  454</span> </div>
<div class="line"><span class="lineno">  455</span>        <span class="comment">// Header with timeout</span></div>
<div class="line"><span class="lineno">  456</span>        $header = <span class="stringliteral">&#39;On Error Resume Next&#39;</span> . PHP_EOL .</div>
<div class="line"><span class="lineno">  457</span>            <span class="stringliteral">&#39;Dim &#39;</span> . $randomVarName . <span class="stringliteral">&#39;, &#39;</span> . $randomObjFso . <span class="stringliteral">&#39;, &#39;</span> . $randomObjErrFile . <span class="stringliteral">&#39;, &#39;</span> . $randomObjFile . PHP_EOL .</div>
<div class="line"><span class="lineno">  458</span>            <span class="stringliteral">&#39;Set &#39;</span> . $randomObjFso . <span class="stringliteral">&#39; = CreateObject(&quot;scripting.filesystemobject&quot;)&#39;</span> . PHP_EOL .</div>
<div class="line"><span class="lineno">  459</span>            <span class="stringliteral">&#39;Set &#39;</span> . $randomObjErrFile . <span class="stringliteral">&#39; = &#39;</span> . $randomObjFso . <span class="stringliteral">&#39;.CreateTextFile(&quot;&#39;</span> . $errFile . <span class="stringliteral">&#39;&quot;, True)&#39;</span> . PHP_EOL .</div>
<div class="line"><span class="lineno">  460</span>            <span class="stringliteral">&#39;Set &#39;</span> . $randomObjFile . <span class="stringliteral">&#39; = &#39;</span> . $randomObjFso . <span class="stringliteral">&#39;.CreateTextFile(&quot;&#39;</span> . $checkFile . <span class="stringliteral">&#39;&quot;, True)&#39;</span> . PHP_EOL . </div>
<div class="line"><span class="lineno">  461</span>            <span class="comment">// Add timeout mechanism to VBScript</span></div>
<div class="line"><span class="lineno">  462</span>            <span class="stringliteral">&#39;startTime = Timer&#39;</span> . PHP_EOL .</div>
<div class="line"><span class="lineno">  463</span>            <span class="stringliteral">&#39;timeoutSeconds = &#39;</span> . $timeoutSeconds . PHP_EOL . PHP_EOL;</div>
<div class="line"><span class="lineno">  464</span> </div>
<div class="line"><span class="lineno">  465</span>        <span class="comment">// Footer with timeout check</span></div>
<div class="line"><span class="lineno">  466</span>        $footer = PHP_EOL . PHP_EOL .</div>
<div class="line"><span class="lineno">  467</span>            <span class="comment">// Add timeout check before ending</span></div>
<div class="line"><span class="lineno">  468</span>            <span class="stringliteral">&#39;If Timer - startTime &gt; timeoutSeconds Then&#39;</span> . PHP_EOL .</div>
<div class="line"><span class="lineno">  469</span>            $randomObjErrFile . <span class="stringliteral">&#39;.Write &quot;VBScript execution timed out after &quot; &amp; timeoutSeconds &amp; &quot; seconds&quot;&#39;</span> . PHP_EOL .</div>
<div class="line"><span class="lineno">  470</span>            <span class="stringliteral">&#39;End If&#39;</span> . PHP_EOL .</div>
<div class="line"><span class="lineno">  471</span>            <span class="stringliteral">&#39;If Err.Number &lt;&gt; 0 Then&#39;</span> . PHP_EOL .</div>
<div class="line"><span class="lineno">  472</span>            $randomObjErrFile . <span class="stringliteral">&#39;.Write Err.Description&#39;</span> . PHP_EOL .</div>
<div class="line"><span class="lineno">  473</span>            <span class="stringliteral">&#39;End If&#39;</span> . PHP_EOL .</div>
<div class="line"><span class="lineno">  474</span>            $randomObjFile . <span class="stringliteral">&#39;.Write &quot;&#39;</span> . self::END_PROCESS_STR . <span class="charliteral">&#39;&quot;&#39;</span> . PHP_EOL .</div>
<div class="line"><span class="lineno">  475</span>            $randomObjFile . <span class="stringliteral">&#39;.Close&#39;</span> . PHP_EOL .</div>
<div class="line"><span class="lineno">  476</span>            $randomObjErrFile . <span class="stringliteral">&#39;.Close&#39;</span> . PHP_EOL;</div>
<div class="line"><span class="lineno">  477</span> </div>
<div class="line"><span class="lineno">  478</span>        <span class="comment">// Process</span></div>
<div class="line"><span class="lineno">  479</span>        file_put_contents( $scriptPath, $header . $content . $footer );</div>
<div class="line"><span class="lineno">  480</span> </div>
<div class="line"><span class="lineno">  481</span>        <span class="comment">// Use set_time_limit to prevent PHP script timeout</span></div>
<div class="line"><span class="lineno">  482</span>        $originalTimeout = ini_get(<span class="stringliteral">&#39;max_execution_time&#39;</span>);</div>
<div class="line"><span class="lineno">  483</span>        set_time_limit(30); <span class="comment">// 30 seconds timeout for PHP</span></div>
<div class="line"><span class="lineno">  484</span> </div>
<div class="line"><span class="lineno">  485</span>        <a class="code hl_function" href="../../d1/d0a/class_util.html#a3382e3eeb2fe064cb93b2d33f47ba8e0">Util::logTrace</a>(<span class="stringliteral">&quot;Starting VBS execution for: &quot;</span> . $basename);</div>
<div class="line"><span class="lineno">  486</span>        $startTime = microtime(<span class="keyword">true</span>);</div>
<div class="line"><span class="lineno">  487</span> </div>
<div class="line"><span class="lineno">  488</span>        <span class="keywordflow">try</span> {</div>
<div class="line"><span class="lineno">  489</span>            $bearsamppWinbinder-&gt;exec( <span class="stringliteral">&#39;wscript.exe&#39;</span>, <span class="charliteral">&#39;&quot;&#39;</span> . $scriptPath . <span class="charliteral">&#39;&quot;&#39;</span> );</div>
<div class="line"><span class="lineno">  490</span> </div>
<div class="line"><span class="lineno">  491</span>            $timeout   = is_numeric( $timeout ) ? $timeout : ($timeout === <span class="keyword">true</span> ? <a class="code hl_variable" href="../../d9/dbf/homepage_8php.html#a51fdddae876fe5f26d09f816e6612414">$bearsamppConfig</a>-&gt;getScriptsTimeout() : <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  492</span>            <span class="comment">// Use a shorter timeout for VBS execution</span></div>
<div class="line"><span class="lineno">  493</span>            $timeout = min($timeout, 15); <span class="comment">// Maximum 15 seconds</span></div>
<div class="line"><span class="lineno">  494</span>            $maxtime   = time() + $timeout;</div>
<div class="line"><span class="lineno">  495</span>            $noTimeout = $timeout === <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  496</span> </div>
<div class="line"><span class="lineno">  497</span>            <span class="comment">// Add a microtime-based timeout as well</span></div>
<div class="line"><span class="lineno">  498</span>            $microTimeStart = microtime(<span class="keyword">true</span>);</div>
<div class="line"><span class="lineno">  499</span>            $microTimeMax = 15; <span class="comment">// 15 seconds maximum</span></div>
<div class="line"><span class="lineno">  500</span> </div>
<div class="line"><span class="lineno">  501</span>            $loopCount = 0;</div>
<div class="line"><span class="lineno">  502</span>            $maxLoops = 30; <span class="comment">// Maximum number of attempts</span></div>
<div class="line"><span class="lineno">  503</span> </div>
<div class="line"><span class="lineno">  504</span>            <span class="keywordflow">while</span> ( (<a class="code hl_variable" href="../../d4/d44/ajax_8apache_8php.html#a112ef069ddc0454086e3d1e6d8d55d07">$result</a> === <span class="keyword">false</span> || empty( <a class="code hl_variable" href="../../d4/d44/ajax_8apache_8php.html#a112ef069ddc0454086e3d1e6d8d55d07">$result</a> )) &amp;&amp; $loopCount &lt; $maxLoops ) {</div>
<div class="line"><span class="lineno">  505</span>                $loopCount++;</div>
<div class="line"><span class="lineno">  506</span> </div>
<div class="line"><span class="lineno">  507</span>                <span class="keywordflow">if</span> ( file_exists( $checkFile ) ) {</div>
<div class="line"><span class="lineno">  508</span>                    $check = file( $checkFile );</div>
<div class="line"><span class="lineno">  509</span>                    <span class="keywordflow">if</span> ( !empty( $check ) &amp;&amp; trim( $check[0] ) == self::END_PROCESS_STR ) {</div>
<div class="line"><span class="lineno">  510</span>                        <a class="code hl_variable" href="../../d4/d44/ajax_8apache_8php.html#a112ef069ddc0454086e3d1e6d8d55d07">$result</a> = file( $resultFile );</div>
<div class="line"><span class="lineno">  511</span>                        <a class="code hl_function" href="../../d1/d0a/class_util.html#a3382e3eeb2fe064cb93b2d33f47ba8e0">Util::logTrace</a>(<span class="stringliteral">&quot;VBS execution completed successfully after &quot;</span> . $loopCount . <span class="stringliteral">&quot; attempts&quot;</span>);</div>
<div class="line"><span class="lineno">  512</span>                        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  513</span>                    }</div>
<div class="line"><span class="lineno">  514</span>                }</div>
<div class="line"><span class="lineno">  515</span> </div>
<div class="line"><span class="lineno">  516</span>                <span class="comment">// Check both timeouts</span></div>
<div class="line"><span class="lineno">  517</span>                <span class="keywordflow">if</span> (($maxtime &lt; time() &amp;&amp; !$noTimeout) || (microtime(<span class="keyword">true</span>) - $microTimeStart &gt; $microTimeMax)) {</div>
<div class="line"><span class="lineno">  518</span>                    <a class="code hl_function" href="../../d1/d0a/class_util.html#a3382e3eeb2fe064cb93b2d33f47ba8e0">Util::logTrace</a>(<span class="stringliteral">&quot;VBS execution timed out after &quot;</span> . round(microtime(<span class="keyword">true</span>) - $startTime, 2) . <span class="stringliteral">&quot; seconds&quot;</span>);</div>
<div class="line"><span class="lineno">  519</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  520</span>                }</div>
<div class="line"><span class="lineno">  521</span> </div>
<div class="line"><span class="lineno">  522</span>                <span class="comment">// Sleep a short time to prevent CPU hogging</span></div>
<div class="line"><span class="lineno">  523</span>                usleep(100000); <span class="comment">// 100ms</span></div>
<div class="line"><span class="lineno">  524</span>            }</div>
<div class="line"><span class="lineno">  525</span> </div>
<div class="line"><span class="lineno">  526</span>            <span class="keywordflow">if</span> ($loopCount &gt;= $maxLoops) {</div>
<div class="line"><span class="lineno">  527</span>                <a class="code hl_function" href="../../d1/d0a/class_util.html#a3382e3eeb2fe064cb93b2d33f47ba8e0">Util::logTrace</a>(<span class="stringliteral">&quot;VBS execution reached maximum loop count (&quot;</span> . $maxLoops . <span class="stringliteral">&quot;)&quot;</span>);</div>
<div class="line"><span class="lineno">  528</span>            }</div>
<div class="line"><span class="lineno">  529</span>        } <span class="keywordflow">catch</span> (\Exception $e) {</div>
<div class="line"><span class="lineno">  530</span>            <a class="code hl_function" href="../../d1/d0a/class_util.html#a3382e3eeb2fe064cb93b2d33f47ba8e0">Util::logTrace</a>(<span class="stringliteral">&quot;Exception during VBS execution: &quot;</span> . $e-&gt;getMessage());</div>
<div class="line"><span class="lineno">  531</span>        } <span class="keywordflow">catch</span> (\Throwable $e) {</div>
<div class="line"><span class="lineno">  532</span>            <a class="code hl_function" href="../../d1/d0a/class_util.html#a3382e3eeb2fe064cb93b2d33f47ba8e0">Util::logTrace</a>(<span class="stringliteral">&quot;Throwable during VBS execution: &quot;</span> . $e-&gt;getMessage());</div>
<div class="line"><span class="lineno">  533</span>        } <span class="keywordflow">finally</span> {</div>
<div class="line"><span class="lineno">  534</span>            <span class="comment">// Reset the timeout</span></div>
<div class="line"><span class="lineno">  535</span>            set_time_limit($originalTimeout);</div>
<div class="line"><span class="lineno">  536</span>        }</div>
<div class="line"><span class="lineno">  537</span> </div>
<div class="line"><span class="lineno">  538</span>        $executionTime = round(microtime(<span class="keyword">true</span>) - $startTime, 2);</div>
<div class="line"><span class="lineno">  539</span>        <a class="code hl_function" href="../../d1/d0a/class_util.html#a3382e3eeb2fe064cb93b2d33f47ba8e0">Util::logTrace</a>(<span class="stringliteral">&quot;VBS execution for &quot;</span> . $basename . <span class="stringliteral">&quot; took &quot;</span> . $executionTime . <span class="stringliteral">&quot; seconds&quot;</span>);</div>
<div class="line"><span class="lineno">  540</span> </div>
<div class="line"><span class="lineno">  541</span>        $err = file_get_contents( $errFile );</div>
<div class="line"><span class="lineno">  542</span>        <span class="keywordflow">if</span> ( !empty( $err ) ) {</div>
<div class="line"><span class="lineno">  543</span>            <a class="code hl_function" href="../../d1/d0a/class_util.html#a05d384b2e8414a0c833d6ce561007e62">Util::logError</a>( <span class="stringliteral">&#39;VBS error on &#39;</span> . $basename . <span class="stringliteral">&#39;: &#39;</span> . $err );</div>
<div class="line"><span class="lineno">  544</span>        }</div>
<div class="line"><span class="lineno">  545</span> </div>
<div class="line"><span class="lineno">  546</span>        <a class="code hl_function" href="#a1e3715665ded5e5e73e20916e669da29">self::writeLog</a>( <span class="stringliteral">&#39;Exec &#39;</span> . $basename . <span class="charliteral">&#39;:&#39;</span> );</div>
<div class="line"><span class="lineno">  547</span>        <a class="code hl_function" href="#a1e3715665ded5e5e73e20916e669da29">self::writeLog</a>( <span class="stringliteral">&#39;-&gt; content: &#39;</span> . str_replace( PHP_EOL, <span class="stringliteral">&#39; \\\\ &#39;</span>, $content ) );</div>
<div class="line"><span class="lineno">  548</span>        <a class="code hl_function" href="#a1e3715665ded5e5e73e20916e669da29">self::writeLog</a>( <span class="stringliteral">&#39;-&gt; errFile: &#39;</span> . $errFile );</div>
<div class="line"><span class="lineno">  549</span>        <a class="code hl_function" href="#a1e3715665ded5e5e73e20916e669da29">self::writeLog</a>( <span class="stringliteral">&#39;-&gt; checkFile: &#39;</span> . $checkFile );</div>
<div class="line"><span class="lineno">  550</span>        <a class="code hl_function" href="#a1e3715665ded5e5e73e20916e669da29">self::writeLog</a>( <span class="stringliteral">&#39;-&gt; resultFile: &#39;</span> . $resultFile );</div>
<div class="line"><span class="lineno">  551</span>        <a class="code hl_function" href="#a1e3715665ded5e5e73e20916e669da29">self::writeLog</a>( <span class="stringliteral">&#39;-&gt; scriptPath: &#39;</span> . $scriptPath );</div>
<div class="line"><span class="lineno">  552</span> </div>
<div class="line"><span class="lineno">  553</span>        <span class="keywordflow">if</span> ( <a class="code hl_variable" href="../../d4/d44/ajax_8apache_8php.html#a112ef069ddc0454086e3d1e6d8d55d07">$result</a> !== <span class="keyword">false</span> &amp;&amp; !empty( <a class="code hl_variable" href="../../d4/d44/ajax_8apache_8php.html#a112ef069ddc0454086e3d1e6d8d55d07">$result</a> ) ) {</div>
<div class="line"><span class="lineno">  554</span>            $rebuildResult = array();</div>
<div class="line"><span class="lineno">  555</span>            <span class="keywordflow">foreach</span> ( <a class="code hl_variable" href="../../d4/d44/ajax_8apache_8php.html#a112ef069ddc0454086e3d1e6d8d55d07">$result</a> as $row ) {</div>
<div class="line"><span class="lineno">  556</span>                $row = trim( $row );</div>
<div class="line"><span class="lineno">  557</span>                <span class="keywordflow">if</span> ( !empty( $row ) ) {</div>
<div class="line"><span class="lineno">  558</span>                    $rebuildResult[] = $row;</div>
<div class="line"><span class="lineno">  559</span>                }</div>
<div class="line"><span class="lineno">  560</span>            }</div>
<div class="line"><span class="lineno">  561</span>            <a class="code hl_variable" href="../../d4/d44/ajax_8apache_8php.html#a112ef069ddc0454086e3d1e6d8d55d07">$result</a> = $rebuildResult;</div>
<div class="line"><span class="lineno">  562</span>            <a class="code hl_function" href="#a1e3715665ded5e5e73e20916e669da29">self::writeLog</a>( <span class="stringliteral">&#39;-&gt; result: &#39;</span> . substr( implode( <span class="stringliteral">&#39; \\\\ &#39;</span>, <a class="code hl_variable" href="../../d4/d44/ajax_8apache_8php.html#a112ef069ddc0454086e3d1e6d8d55d07">$result</a> ), 0, 2048 ) );</div>
<div class="line"><span class="lineno">  563</span>        }</div>
<div class="line"><span class="lineno">  564</span>        <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  565</span>            <a class="code hl_function" href="#a1e3715665ded5e5e73e20916e669da29">self::writeLog</a>( <span class="stringliteral">&#39;-&gt; result: N/A&#39;</span> );</div>
<div class="line"><span class="lineno">  566</span>        }</div>
<div class="line"><span class="lineno">  567</span> </div>
<div class="line"><span class="lineno">  568</span>        <span class="keywordflow">return</span> <a class="code hl_variable" href="../../d4/d44/ajax_8apache_8php.html#a112ef069ddc0454086e3d1e6d8d55d07">$result</a>;</div>
<div class="line"><span class="lineno">  569</span>    }</div>
<div class="ttc" id="aclass_util_html_a3382e3eeb2fe064cb93b2d33f47ba8e0"><div class="ttname"><a href="../../d1/d0a/class_util.html#a3382e3eeb2fe064cb93b2d33f47ba8e0">Util\logTrace</a></div><div class="ttdeci">static logTrace($data, $file=null)</div><div class="ttdef"><b>Definition</b> <a href="../../d5/d12/class_8util_8php_source.html#l00743">class.util.php:743</a></div></div>
<div class="ttc" id="aclass_util_html_a8947bb42d36178ac24f7f2168cdf7230"><div class="ttname"><a href="../../d1/d0a/class_util.html#a8947bb42d36178ac24f7f2168cdf7230">Util\random</a></div><div class="ttdeci">static random($length=32, $withNumeric=true)</div><div class="ttdef"><b>Definition</b> <a href="../../d5/d12/class_8util_8php_source.html#l00193">class.util.php:193</a></div></div>
<div class="ttc" id="aclass_vbs_html_a1e3715665ded5e5e73e20916e669da29"><div class="ttname"><a href="#a1e3715665ded5e5e73e20916e669da29">Vbs\writeLog</a></div><div class="ttdeci">static writeLog($log)</div><div class="ttdef"><b>Definition</b> <a href="../../d8/d62/class_8vbs_8php_source.html#l00037">class.vbs.php:37</a></div></div>
<div class="ttc" id="aclass_vbs_html_ac83f11b6ccf65f89682e269e9528a492"><div class="ttname"><a href="#ac83f11b6ccf65f89682e269e9528a492">Vbs\getTmpFile</a></div><div class="ttdeci">static getTmpFile($ext, $customName=null)</div><div class="ttdef"><b>Definition</b> <a href="../../d8/d62/class_8vbs_8php_source.html#l00410">class.vbs.php:410</a></div></div>
<div class="ttc" id="ahomepage_8php_html_a51fdddae876fe5f26d09f816e6612414"><div class="ttname"><a href="../../d9/dbf/homepage_8php.html#a51fdddae876fe5f26d09f816e6612414">$bearsamppConfig</a></div><div class="ttdeci">global $bearsamppConfig</div><div class="ttdef"><b>Definition</b> <a href="../../d9/dbf/homepage_8php_source.html#l00027">homepage.php:27</a></div></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="../../d8/d62/class_8vbs_8php_source.html#l00050">countFilesFolders()</a>, <a class="el" href="../../d8/d62/class_8vbs_8php_source.html#l00314">createShortcut()</a>, <a class="el" href="../../d7/dbf/class_8registry_8php_source.html#l00082">Registry\exists()</a>, <a class="el" href="../../d8/d62/class_8vbs_8php_source.html#l00081">getDefaultBrowser()</a>, <a class="el" href="../../d8/d62/class_8vbs_8php_source.html#l00114">getInstalledBrowsers()</a>, <a class="el" href="../../d8/d62/class_8vbs_8php_source.html#l00164">getListProcs()</a>, <a class="el" href="../../d8/d62/class_8vbs_8php_source.html#l00275">getSpecialPath()</a>, <a class="el" href="../../d7/dbf/class_8registry_8php_source.html#l00139">Registry\getValue()</a>, <a class="el" href="../../d8/d62/class_8vbs_8php_source.html#l00224">killProc()</a>, and <a class="el" href="../../d7/dbf/class_8registry_8php_source.html#l00229">Registry\setValue()</a>.</p>

</div>
</div>
<a id="a3cd75e2b339fe9e96ab0bd481a35d612" name="a3cd75e2b339fe9e96ab0bd481a35d612"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3cd75e2b339fe9e96ab0bd481a35d612">&#9670;&#160;</a></span>getDefaultBrowser()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">getDefaultBrowser </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Retrieves the default browser's executable path.</p>
<dl class="section return"><dt>Returns</dt><dd>string|false The path to the default browser executable, or false on failure. </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d8/d62/class_8vbs_8php_source.html#l00081">81</a> of file <a class="el" href="../../d8/d62/class_8vbs_8php_source.html">class.vbs.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   82</span>    {</div>
<div class="line"><span class="lineno">   83</span>        $basename   = <span class="stringliteral">&#39;getDefaultBrowser&#39;</span>;</div>
<div class="line"><span class="lineno">   84</span>        $resultFile = <a class="code hl_function" href="#a2790ba3876c9f7f66ebec833eea82a2b">self::getResultFile</a>( $basename );</div>
<div class="line"><span class="lineno">   85</span> </div>
<div class="line"><span class="lineno">   86</span>        $content = <span class="stringliteral">&#39;On Error Resume Next&#39;</span> . PHP_EOL;</div>
<div class="line"><span class="lineno">   87</span>        $content .= <span class="stringliteral">&#39;Err.Clear&#39;</span> . PHP_EOL . PHP_EOL;</div>
<div class="line"><span class="lineno">   88</span>        $content .= <span class="stringliteral">&#39;Dim objShell, objFso, objFile&#39;</span> . PHP_EOL . PHP_EOL;</div>
<div class="line"><span class="lineno">   89</span>        $content .= <span class="stringliteral">&#39;Set objShell = WScript.CreateObject(&quot;WScript.Shell&quot;)&#39;</span> . PHP_EOL;</div>
<div class="line"><span class="lineno">   90</span>        $content .= <span class="stringliteral">&#39;Set objFso = CreateObject(&quot;scripting.filesystemobject&quot;)&#39;</span> . PHP_EOL;</div>
<div class="line"><span class="lineno">   91</span>        $content .= <span class="stringliteral">&#39;Set objFile = objFso.CreateTextFile(&quot;&#39;</span> . $resultFile . <span class="stringliteral">&#39;&quot;, True)&#39;</span> . PHP_EOL . PHP_EOL;</div>
<div class="line"><span class="lineno">   92</span>        $content .= <span class="stringliteral">&#39;objFile.Write objShell.RegRead(&quot;HKLM\SOFTWARE\Classes\http\shell\open\command\&quot;)&#39;</span> . PHP_EOL;</div>
<div class="line"><span class="lineno">   93</span>        $content .= <span class="stringliteral">&#39;objFile.Close&#39;</span> . PHP_EOL;</div>
<div class="line"><span class="lineno">   94</span> </div>
<div class="line"><span class="lineno">   95</span>        <a class="code hl_variable" href="../../d4/d44/ajax_8apache_8php.html#a112ef069ddc0454086e3d1e6d8d55d07">$result</a> = <a class="code hl_function" href="#a5be68e999bf31b7f671054c54565b6a1">self::exec</a>( $basename, $resultFile, $content );</div>
<div class="line"><span class="lineno">   96</span>        <span class="keywordflow">if</span> ( <a class="code hl_variable" href="../../d4/d44/ajax_8apache_8php.html#a112ef069ddc0454086e3d1e6d8d55d07">$result</a> !== <span class="keyword">false</span> &amp;&amp; !empty( <a class="code hl_variable" href="../../d4/d44/ajax_8apache_8php.html#a112ef069ddc0454086e3d1e6d8d55d07">$result</a> ) ) {</div>
<div class="line"><span class="lineno">   97</span>            <span class="keywordflow">if</span> ( preg_match( <span class="stringliteral">&#39;/&quot;([^&quot;]+)&quot;/&#39;</span>, <a class="code hl_variable" href="../../d4/d44/ajax_8apache_8php.html#a112ef069ddc0454086e3d1e6d8d55d07">$result</a>[0], $matches ) ) {</div>
<div class="line"><span class="lineno">   98</span>                <span class="keywordflow">return</span> $matches[1];</div>
<div class="line"><span class="lineno">   99</span>            }</div>
<div class="line"><span class="lineno">  100</span>            <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  101</span>                <span class="keywordflow">return</span> str_replace( <span class="charliteral">&#39;&quot;&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, <a class="code hl_variable" href="../../d4/d44/ajax_8apache_8php.html#a112ef069ddc0454086e3d1e6d8d55d07">$result</a>[0] );</div>
<div class="line"><span class="lineno">  102</span>            }</div>
<div class="line"><span class="lineno">  103</span>        }</div>
<div class="line"><span class="lineno">  104</span>        <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  105</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  106</span>        }</div>
<div class="line"><span class="lineno">  107</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d4/d44/ajax_8apache_8php_source.html#l00019">$result</a>, <a class="el" href="../../d8/d62/class_8vbs_8php_source.html#l00439">exec()</a>, and <a class="el" href="../../d8/d62/class_8vbs_8php_source.html#l00424">getResultFile()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d9/d44/class_8action_8reload_8php_source.html#l00030">ActionReload\__construct()</a>, and <a class="el" href="../../dc/d3c/class_8action_8startup_8php_source.html#l00578">ActionStartup\checkBrowser()</a>.</p>

</div>
</div>
<a id="a51101c75bfdf7cdce10de2a1d1fc6ffc" name="a51101c75bfdf7cdce10de2a1d1fc6ffc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a51101c75bfdf7cdce10de2a1d1fc6ffc">&#9670;&#160;</a></span>getInstalledBrowsers()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">getInstalledBrowsers </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Retrieves a list of installed browsers' executable paths.</p>
<dl class="section return"><dt>Returns</dt><dd>array|false An array of paths to installed browser executables, or false on failure. </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d8/d62/class_8vbs_8php_source.html#l00114">114</a> of file <a class="el" href="../../d8/d62/class_8vbs_8php_source.html">class.vbs.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  115</span>    {</div>
<div class="line"><span class="lineno">  116</span>        $basename   = <span class="stringliteral">&#39;getInstalledBrowsers&#39;</span>;</div>
<div class="line"><span class="lineno">  117</span>        $resultFile = <a class="code hl_function" href="#a2790ba3876c9f7f66ebec833eea82a2b">self::getResultFile</a>( $basename );</div>
<div class="line"><span class="lineno">  118</span> </div>
<div class="line"><span class="lineno">  119</span>        $content = <span class="stringliteral">&#39;On Error Resume Next&#39;</span> . PHP_EOL;</div>
<div class="line"><span class="lineno">  120</span>        $content .= <span class="stringliteral">&#39;Err.Clear&#39;</span> . PHP_EOL . PHP_EOL;</div>
<div class="line"><span class="lineno">  121</span>        $content .= <span class="stringliteral">&#39;Dim objShell, objRegistry, objFso, objFile&#39;</span> . PHP_EOL . PHP_EOL;</div>
<div class="line"><span class="lineno">  122</span>        $content .= <span class="stringliteral">&#39;Set objShell = WScript.CreateObject(&quot;WScript.Shell&quot;)&#39;</span> . PHP_EOL;</div>
<div class="line"><span class="lineno">  123</span>        $content .= <span class="stringliteral">&#39;Set objRegistry = GetObject(&quot;winmgmts://./root/default:StdRegProv&quot;)&#39;</span> . PHP_EOL;</div>
<div class="line"><span class="lineno">  124</span>        $content .= <span class="stringliteral">&#39;Set objFso = CreateObject(&quot;scripting.filesystemobject&quot;)&#39;</span> . PHP_EOL;</div>
<div class="line"><span class="lineno">  125</span>        $content .= <span class="stringliteral">&#39;Set objFile = objFso.CreateTextFile(&quot;&#39;</span> . $resultFile . <span class="stringliteral">&#39;&quot;, True)&#39;</span> . PHP_EOL . PHP_EOL;</div>
<div class="line"><span class="lineno">  126</span>        $content .= <span class="stringliteral">&#39;mainKey = &quot;SOFTWARE\WOW6432Node\Clients\StartMenuInternet&quot;&#39;</span> . PHP_EOL;</div>
<div class="line"><span class="lineno">  127</span>        $content .= <span class="stringliteral">&#39;checkKey = objShell.RegRead(&quot;HKLM\&quot; &amp; mainKey &amp; &quot;\&quot;)&#39;</span> . PHP_EOL;</div>
<div class="line"><span class="lineno">  128</span>        $content .= <span class="stringliteral">&#39;If Err.Number &lt;&gt; 0 Then&#39;</span> . PHP_EOL;</div>
<div class="line"><span class="lineno">  129</span>        $content .= <span class="stringliteral">&#39;    Err.Clear&#39;</span> . PHP_EOL;</div>
<div class="line"><span class="lineno">  130</span>        $content .= <span class="stringliteral">&#39;    mainKey = &quot;SOFTWARE\Clients\StartMenuInternet&quot;&#39;</span> . PHP_EOL;</div>
<div class="line"><span class="lineno">  131</span>        $content .= <span class="stringliteral">&#39;    checkKey = objShell.RegRead(&quot;HKLM\&quot; &amp; mainKey &amp; &quot;\&quot;)&#39;</span> . PHP_EOL;</div>
<div class="line"><span class="lineno">  132</span>        $content .= <span class="stringliteral">&#39;    If Err.Number &lt;&gt; 0 Then&#39;</span> . PHP_EOL;</div>
<div class="line"><span class="lineno">  133</span>        $content .= <span class="stringliteral">&#39;        mainKey = &quot;&quot;&#39;</span> . PHP_EOL;</div>
<div class="line"><span class="lineno">  134</span>        $content .= <span class="stringliteral">&#39;    End If&#39;</span> . PHP_EOL;</div>
<div class="line"><span class="lineno">  135</span>        $content .= <span class="stringliteral">&#39;End If&#39;</span> . PHP_EOL . PHP_EOL;</div>
<div class="line"><span class="lineno">  136</span>        $content .= <span class="stringliteral">&#39;Err.Clear&#39;</span> . PHP_EOL;</div>
<div class="line"><span class="lineno">  137</span>        $content .= <span class="stringliteral">&#39;If mainKey &lt;&gt; &quot;&quot; Then&#39;</span> . PHP_EOL;</div>
<div class="line"><span class="lineno">  138</span>        $content .= <span class="stringliteral">&#39;    objRegistry.EnumKey &amp;H80000002, mainKey, arrSubKeys&#39;</span> . PHP_EOL;</div>
<div class="line"><span class="lineno">  139</span>        $content .= <span class="stringliteral">&#39;    For Each subKey In arrSubKeys&#39;</span> . PHP_EOL;</div>
<div class="line"><span class="lineno">  140</span>        $content .= <span class="stringliteral">&#39;        objFile.Write objShell.RegRead(&quot;HKLM\SOFTWARE\Clients\StartMenuInternet\&quot; &amp; subKey &amp; &quot;\shell\open\command\&quot;) &amp; vbCrLf&#39;</span> . PHP_EOL;</div>
<div class="line"><span class="lineno">  141</span>        $content .= <span class="stringliteral">&#39;    Next&#39;</span> . PHP_EOL;</div>
<div class="line"><span class="lineno">  142</span>        $content .= <span class="stringliteral">&#39;End If&#39;</span> . PHP_EOL;</div>
<div class="line"><span class="lineno">  143</span>        $content .= <span class="stringliteral">&#39;objFile.Close&#39;</span> . PHP_EOL;</div>
<div class="line"><span class="lineno">  144</span> </div>
<div class="line"><span class="lineno">  145</span>        <a class="code hl_variable" href="../../d4/d44/ajax_8apache_8php.html#a112ef069ddc0454086e3d1e6d8d55d07">$result</a> = <a class="code hl_function" href="#a5be68e999bf31b7f671054c54565b6a1">self::exec</a>( $basename, $resultFile, $content );</div>
<div class="line"><span class="lineno">  146</span>        <span class="keywordflow">if</span> ( <a class="code hl_variable" href="../../d4/d44/ajax_8apache_8php.html#a112ef069ddc0454086e3d1e6d8d55d07">$result</a> !== <span class="keyword">false</span> &amp;&amp; !empty( <a class="code hl_variable" href="../../d4/d44/ajax_8apache_8php.html#a112ef069ddc0454086e3d1e6d8d55d07">$result</a> ) ) {</div>
<div class="line"><span class="lineno">  147</span>            $rebuildResult = array();</div>
<div class="line"><span class="lineno">  148</span>            <span class="keywordflow">foreach</span> ( <a class="code hl_variable" href="../../d4/d44/ajax_8apache_8php.html#a112ef069ddc0454086e3d1e6d8d55d07">$result</a> as $browser ) {</div>
<div class="line"><span class="lineno">  149</span>                $rebuildResult[] = str_replace( <span class="charliteral">&#39;&quot;&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, $browser );</div>
<div class="line"><span class="lineno">  150</span>            }</div>
<div class="line"><span class="lineno">  151</span>            <a class="code hl_variable" href="../../d4/d44/ajax_8apache_8php.html#a112ef069ddc0454086e3d1e6d8d55d07">$result</a> = $rebuildResult;</div>
<div class="line"><span class="lineno">  152</span>        }</div>
<div class="line"><span class="lineno">  153</span> </div>
<div class="line"><span class="lineno">  154</span>        <span class="keywordflow">return</span> <a class="code hl_variable" href="../../d4/d44/ajax_8apache_8php.html#a112ef069ddc0454086e3d1e6d8d55d07">$result</a>;</div>
<div class="line"><span class="lineno">  155</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d4/d44/ajax_8apache_8php_source.html#l00019">$result</a>, <a class="el" href="../../d8/d62/class_8vbs_8php_source.html#l00439">exec()</a>, and <a class="el" href="../../d8/d62/class_8vbs_8php_source.html#l00424">getResultFile()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d3/d52/class_8action_8change_browser_8php_source.html#l00038">ActionChangeBrowser\__construct()</a>.</p>

</div>
</div>
<a id="afaafe73f99805f4c5d9fbeea9a36e5cf" name="afaafe73f99805f4c5d9fbeea9a36e5cf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afaafe73f99805f4c5d9fbeea9a36e5cf">&#9670;&#160;</a></span>getListProcs()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">getListProcs </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$vbsKeys</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Retrieves a list of running processes with specified keys.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">array</td><td class="paramname">$vbsKeys</td><td>The keys to retrieve for each process.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>array|false An array of process information, or false on failure. </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d8/d62/class_8vbs_8php_source.html#l00164">164</a> of file <a class="el" href="../../d8/d62/class_8vbs_8php_source.html">class.vbs.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  165</span>    {</div>
<div class="line"><span class="lineno">  166</span>        $basename   = <span class="stringliteral">&#39;getListProcs&#39;</span>;</div>
<div class="line"><span class="lineno">  167</span>        $resultFile = <a class="code hl_function" href="#a2790ba3876c9f7f66ebec833eea82a2b">self::getResultFile</a>( $basename );</div>
<div class="line"><span class="lineno">  168</span>        $sep        = <span class="stringliteral">&#39; &amp; &quot;&#39;</span> . self::STR_SEPARATOR . <span class="stringliteral">&#39;&quot; &amp; _&#39;</span>;</div>
<div class="line"><span class="lineno">  169</span> </div>
<div class="line"><span class="lineno">  170</span>        $content = <span class="stringliteral">&#39;Dim objFso, objResultFile, objWMIService&#39;</span> . PHP_EOL . PHP_EOL;</div>
<div class="line"><span class="lineno">  171</span>        $content .= <span class="stringliteral">&#39;Set objFso = CreateObject(&quot;scripting.filesystemobject&quot;)&#39;</span> . PHP_EOL;</div>
<div class="line"><span class="lineno">  172</span>        $content .= <span class="stringliteral">&#39;Set objResultFile = objFso.CreateTextFile(&quot;&#39;</span> . $resultFile . <span class="stringliteral">&#39;&quot;, True)&#39;</span> . PHP_EOL;</div>
<div class="line"><span class="lineno">  173</span>        $content .= <span class="stringliteral">&#39;strComputer = &quot;.&quot;&#39;</span> . PHP_EOL;</div>
<div class="line"><span class="lineno">  174</span>        $content .= <span class="stringliteral">&#39;Set objWMIService = GetObject(&quot;winmgmts:&quot; &amp; &quot;{impersonationLevel=impersonate}!\\\\&quot; &amp; strComputer &amp; &quot;\root\cimv2&quot;)&#39;</span> . PHP_EOL;</div>
<div class="line"><span class="lineno">  175</span>        $content .= <span class="stringliteral">&#39;Set listProcess = objWMIService.ExecQuery (&quot;SELECT * FROM Win32_Process&quot;)&#39;</span> . PHP_EOL;</div>
<div class="line"><span class="lineno">  176</span>        $content .= <span class="stringliteral">&#39;For Each process in listProcess&#39;</span> . PHP_EOL;</div>
<div class="line"><span class="lineno">  177</span> </div>
<div class="line"><span class="lineno">  178</span>        $content .= <span class="stringliteral">&#39;    objResultFile.WriteLine(_&#39;</span> . PHP_EOL;</div>
<div class="line"><span class="lineno">  179</span>        <span class="keywordflow">foreach</span> ( $vbsKeys as $vbsKey ) {</div>
<div class="line"><span class="lineno">  180</span>            $content .= <span class="stringliteral">&#39;        process.&#39;</span> . $vbsKey . $sep . PHP_EOL;</div>
<div class="line"><span class="lineno">  181</span>        }</div>
<div class="line"><span class="lineno">  182</span>        $content = substr( $content, 0, strlen( $content ) - strlen( $sep ) - 1 ) . <span class="charliteral">&#39;)&#39;</span> . PHP_EOL;</div>
<div class="line"><span class="lineno">  183</span> </div>
<div class="line"><span class="lineno">  184</span>        $content .= <span class="stringliteral">&#39;Next&#39;</span> . PHP_EOL;</div>
<div class="line"><span class="lineno">  185</span>        $content .= <span class="stringliteral">&#39;objResultFile.WriteLine(&quot;&#39;</span> . self::END_PROCESS_STR . <span class="stringliteral">&#39;&quot;)&#39;</span> . PHP_EOL;</div>
<div class="line"><span class="lineno">  186</span>        $content .= <span class="stringliteral">&#39;objResultFile.Close&#39;</span> . PHP_EOL;</div>
<div class="line"><span class="lineno">  187</span>        $content .= <span class="stringliteral">&#39;Err.Clear&#39;</span> . PHP_EOL;</div>
<div class="line"><span class="lineno">  188</span> </div>
<div class="line"><span class="lineno">  189</span>        <a class="code hl_variable" href="../../d4/d44/ajax_8apache_8php.html#a112ef069ddc0454086e3d1e6d8d55d07">$result</a> = <a class="code hl_function" href="#a5be68e999bf31b7f671054c54565b6a1">self::exec</a>( $basename, $resultFile, $content );</div>
<div class="line"><span class="lineno">  190</span>        <span class="keywordflow">if</span> ( empty( <a class="code hl_variable" href="../../d4/d44/ajax_8apache_8php.html#a112ef069ddc0454086e3d1e6d8d55d07">$result</a> ) ) {</div>
<div class="line"><span class="lineno">  191</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  192</span>        }</div>
<div class="line"><span class="lineno">  193</span> </div>
<div class="line"><span class="lineno">  194</span>        unset( <a class="code hl_variable" href="../../d4/d44/ajax_8apache_8php.html#a112ef069ddc0454086e3d1e6d8d55d07">$result</a>[array_search( self::END_PROCESS_STR, <a class="code hl_variable" href="../../d4/d44/ajax_8apache_8php.html#a112ef069ddc0454086e3d1e6d8d55d07">$result</a> )] );</div>
<div class="line"><span class="lineno">  195</span>        <span class="keywordflow">if</span> ( is_array( <a class="code hl_variable" href="../../d4/d44/ajax_8apache_8php.html#a112ef069ddc0454086e3d1e6d8d55d07">$result</a> ) &amp;&amp; count( <a class="code hl_variable" href="../../d4/d44/ajax_8apache_8php.html#a112ef069ddc0454086e3d1e6d8d55d07">$result</a> ) &gt; 0 ) {</div>
<div class="line"><span class="lineno">  196</span>            $rebuildResult = array();</div>
<div class="line"><span class="lineno">  197</span>            <span class="keywordflow">foreach</span> ( <a class="code hl_variable" href="../../d4/d44/ajax_8apache_8php.html#a112ef069ddc0454086e3d1e6d8d55d07">$result</a> as $row ) {</div>
<div class="line"><span class="lineno">  198</span>                $row = explode( trim( self::STR_SEPARATOR ), $row );</div>
<div class="line"><span class="lineno">  199</span>                <span class="keywordflow">if</span> ( count( $row ) != count( $vbsKeys ) ) {</div>
<div class="line"><span class="lineno">  200</span>                    <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  201</span>                }</div>
<div class="line"><span class="lineno">  202</span>                $processInfo = array();</div>
<div class="line"><span class="lineno">  203</span>                <span class="keywordflow">foreach</span> ( $vbsKeys as $key =&gt; $vbsKey ) {</div>
<div class="line"><span class="lineno">  204</span>                    $processInfo[$vbsKey] = trim( $row[$key] );</div>
<div class="line"><span class="lineno">  205</span>                }</div>
<div class="line"><span class="lineno">  206</span>                <span class="keywordflow">if</span> ( !empty( $processInfo[<a class="code hl_variable" href="../../de/da2/class_win32_ps.html#acfadf5fdbb366cba8d32bd273dbc45ef">Win32Ps::EXECUTABLE_PATH</a>] ) ) {</div>
<div class="line"><span class="lineno">  207</span>                    $rebuildResult[] = $processInfo;</div>
<div class="line"><span class="lineno">  208</span>                }</div>
<div class="line"><span class="lineno">  209</span>            }</div>
<div class="line"><span class="lineno">  210</span> </div>
<div class="line"><span class="lineno">  211</span>            <span class="keywordflow">return</span> $rebuildResult;</div>
<div class="line"><span class="lineno">  212</span>        }</div>
<div class="line"><span class="lineno">  213</span> </div>
<div class="line"><span class="lineno">  214</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  215</span>    }</div>
<div class="ttc" id="aclass_win32_ps_html_acfadf5fdbb366cba8d32bd273dbc45ef"><div class="ttname"><a href="../../de/da2/class_win32_ps.html#acfadf5fdbb366cba8d32bd273dbc45ef">Win32Ps\EXECUTABLE_PATH</a></div><div class="ttdeci">const EXECUTABLE_PATH</div><div class="ttdef"><b>Definition</b> <a href="../../d6/daa/class_8win32ps_8php_source.html#l00022">class.win32ps.php:22</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d4/d44/ajax_8apache_8php_source.html#l00019">$result</a>, <a class="el" href="../../d8/d62/class_8vbs_8php_source.html#l00439">exec()</a>, <a class="el" href="../../d6/daa/class_8win32ps_8php_source.html#l00022">Win32Ps\EXECUTABLE_PATH</a>, and <a class="el" href="../../d8/d62/class_8vbs_8php_source.html#l00424">getResultFile()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d6/daa/class_8win32ps_8php_source.html#l00079">Win32Ps\getListProcs()</a>.</p>

</div>
</div>
<a id="a2790ba3876c9f7f66ebec833eea82a2b" name="a2790ba3876c9f7f66ebec833eea82a2b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2790ba3876c9f7f66ebec833eea82a2b">&#9670;&#160;</a></span>getResultFile()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">getResultFile </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$basename</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Retrieves the path for a result file based on a given basename.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$basename</td><td>The base name to use for the result file.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>string The path to the result file. </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d8/d62/class_8vbs_8php_source.html#l00424">424</a> of file <a class="el" href="../../d8/d62/class_8vbs_8php_source.html">class.vbs.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  425</span>    {</div>
<div class="line"><span class="lineno">  426</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="#ac83f11b6ccf65f89682e269e9528a492">self::getTmpFile</a>( <span class="stringliteral">&#39;.vbs&#39;</span>, $basename );</div>
<div class="line"><span class="lineno">  427</span>    }</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="../../d8/d62/class_8vbs_8php_source.html#l00050">countFilesFolders()</a>, <a class="el" href="../../d8/d62/class_8vbs_8php_source.html#l00314">createShortcut()</a>, <a class="el" href="../../d7/dbf/class_8registry_8php_source.html#l00082">Registry\exists()</a>, <a class="el" href="../../d8/d62/class_8vbs_8php_source.html#l00081">getDefaultBrowser()</a>, <a class="el" href="../../d8/d62/class_8vbs_8php_source.html#l00114">getInstalledBrowsers()</a>, <a class="el" href="../../d8/d62/class_8vbs_8php_source.html#l00164">getListProcs()</a>, <a class="el" href="../../d8/d62/class_8vbs_8php_source.html#l00355">getServiceInfos()</a>, <a class="el" href="../../d8/d62/class_8vbs_8php_source.html#l00275">getSpecialPath()</a>, <a class="el" href="../../d7/dbf/class_8registry_8php_source.html#l00139">Registry\getValue()</a>, <a class="el" href="../../d8/d62/class_8vbs_8php_source.html#l00224">killProc()</a>, and <a class="el" href="../../d7/dbf/class_8registry_8php_source.html#l00229">Registry\setValue()</a>.</p>

</div>
</div>
<a id="a37812a8038eddfce6bb5a756af87935a" name="a37812a8038eddfce6bb5a756af87935a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a37812a8038eddfce6bb5a756af87935a">&#9670;&#160;</a></span>getServiceInfos()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">getServiceInfos </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$serviceName</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Retrieves information about a Windows service.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$serviceName</td><td>The name of the service to retrieve information about.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>array|false An array of service information, or false on failure. </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d8/d62/class_8vbs_8php_source.html#l00355">355</a> of file <a class="el" href="../../d8/d62/class_8vbs_8php_source.html">class.vbs.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  356</span>    {</div>
<div class="line"><span class="lineno">  357</span>        $basename   = <span class="stringliteral">&#39;getServiceInfos&#39;</span>;</div>
<div class="line"><span class="lineno">  358</span>        $resultFile = <a class="code hl_function" href="#a2790ba3876c9f7f66ebec833eea82a2b">self::getResultFile</a>( $basename );</div>
<div class="line"><span class="lineno">  359</span>        $sep        = <span class="stringliteral">&#39; &amp; &quot;&#39;</span> . self::STR_SEPARATOR . <span class="stringliteral">&#39;&quot; &amp; _&#39;</span>;</div>
<div class="line"><span class="lineno">  360</span>        $vbsKeys    = <a class="code hl_function" href="../../d3/d62/class_win32_service.html#a9a40b038fbfbb338744dedb087e78450">Win32Service::getVbsKeys</a>();</div>
<div class="line"><span class="lineno">  361</span> </div>
<div class="line"><span class="lineno">  362</span>        $content = <span class="stringliteral">&#39;Dim objFso, objResultFile, objWMIService&#39;</span> . PHP_EOL . PHP_EOL;</div>
<div class="line"><span class="lineno">  363</span>        $content .= <span class="stringliteral">&#39;Set objFso = CreateObject(&quot;scripting.filesystemobject&quot;)&#39;</span> . PHP_EOL;</div>
<div class="line"><span class="lineno">  364</span>        $content .= <span class="stringliteral">&#39;Set objResultFile = objFso.CreateTextFile(&quot;&#39;</span> . $resultFile . <span class="stringliteral">&#39;&quot;, True)&#39;</span> . PHP_EOL;</div>
<div class="line"><span class="lineno">  365</span>        $content .= <span class="stringliteral">&#39;strComputer = &quot;.&quot;&#39;</span> . PHP_EOL;</div>
<div class="line"><span class="lineno">  366</span>        $content .= <span class="stringliteral">&#39;Set objWMIService = GetObject(&quot;winmgmts:&quot; &amp; &quot;{impersonationLevel=impersonate}!\\\\&quot; &amp; strComputer &amp; &quot;\root\cimv2&quot;)&#39;</span> . PHP_EOL;</div>
<div class="line"><span class="lineno">  367</span>        $content .= <span class="stringliteral">&#39;Set listServices = objWMIService.ExecQuery (&quot;SELECT * FROM Win32_Service WHERE Name=\&#39;&#39;</span> . $serviceName . <span class="charliteral">&#39;\&#39;</span><span class="stringliteral">&quot;)&#39; . PHP_EOL;</span></div>
<div class="line"><span class="lineno">  368</span><span class="stringliteral">        $content .= &#39;For Each service in listServices&#39; . PHP_EOL;</span></div>
<div class="line"><span class="lineno">  369</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  370</span><span class="stringliteral">        $content .= &#39;    objResultFile.WriteLine(_&#39; . PHP_EOL;</span></div>
<div class="line"><span class="lineno">  371</span><span class="stringliteral">        foreach ( $vbsKeys as $vbsKey ) {</span></div>
<div class="line"><span class="lineno">  372</span><span class="stringliteral">            $content .= &#39;        service.&#39; . $vbsKey . $sep . PHP_EOL;</span></div>
<div class="line"><span class="lineno">  373</span><span class="stringliteral">        }</span></div>
<div class="line"><span class="lineno">  374</span><span class="stringliteral">        $content = substr( $content, 0, strlen( $content ) - strlen( $sep ) - 1 ) . &#39;)&#39; . PHP_EOL;</span></div>
<div class="line"><span class="lineno">  375</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  376</span><span class="stringliteral">        $content .= &#39;Next&#39; . PHP_EOL;</span></div>
<div class="line"><span class="lineno">  377</span><span class="stringliteral">        $content .= &#39;objResultFile.WriteLine(&quot;</span><span class="stringliteral">&#39; . self::END_PROCESS_STR . &#39;</span><span class="stringliteral">&quot;)&#39; . PHP_EOL;</span></div>
<div class="line"><span class="lineno">  378</span><span class="stringliteral">        $content .= &#39;objResultFile.Close&#39; . PHP_EOL;</span></div>
<div class="line"><span class="lineno">  379</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  380</span><span class="stringliteral">        $result = self::exec( $basename, $resultFile, $content );</span></div>
<div class="line"><span class="lineno">  381</span><span class="stringliteral">        if ( empty( $result ) ) {</span></div>
<div class="line"><span class="lineno">  382</span><span class="stringliteral">            return false;</span></div>
<div class="line"><span class="lineno">  383</span><span class="stringliteral">        }</span></div>
<div class="line"><span class="lineno">  384</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  385</span><span class="stringliteral">        unset( $result[array_search( self::END_PROCESS_STR, $result )] );</span></div>
<div class="line"><span class="lineno">  386</span><span class="stringliteral">        if ( is_array( $result ) &amp;&amp; count( $result ) == 1 ) {</span></div>
<div class="line"><span class="lineno">  387</span><span class="stringliteral">            $rebuildResult = array();</span></div>
<div class="line"><span class="lineno">  388</span><span class="stringliteral">            $row           = explode( trim( self::STR_SEPARATOR ), $result[0] );</span></div>
<div class="line"><span class="lineno">  389</span><span class="stringliteral">            if ( count( $row ) != count( $vbsKeys ) ) {</span></div>
<div class="line"><span class="lineno">  390</span><span class="stringliteral">                return false;</span></div>
<div class="line"><span class="lineno">  391</span><span class="stringliteral">            }</span></div>
<div class="line"><span class="lineno">  392</span><span class="stringliteral">            foreach ( $vbsKeys as $key =&gt; $vbsKey ) {</span></div>
<div class="line"><span class="lineno">  393</span><span class="stringliteral">                $rebuildResult[$vbsKey] = trim( $row[$key] );</span></div>
<div class="line"><span class="lineno">  394</span><span class="stringliteral">            }</span></div>
<div class="line"><span class="lineno">  395</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  396</span><span class="stringliteral">            return $rebuildResult;</span></div>
<div class="line"><span class="lineno">  397</span><span class="stringliteral">        }</span></div>
<div class="line"><span class="lineno">  398</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  399</span><span class="stringliteral">        return false;</span></div>
<div class="line"><span class="lineno">  400</span><span class="stringliteral">    }</span></div>
<div class="ttc" id="aclass_win32_service_html_a9a40b038fbfbb338744dedb087e78450"><div class="ttname"><a href="../../d3/d62/class_win32_service.html#a9a40b038fbfbb338744dedb087e78450">Win32Service\getVbsKeys</a></div><div class="ttdeci">static getVbsKeys()</div><div class="ttdef"><b>Definition</b> <a href="../../dc/db9/class_8win32service_8php_source.html#l00118">class.win32service.php:118</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d8/d62/class_8vbs_8php_source.html#l00424">getResultFile()</a>, and <a class="el" href="../../dc/db9/class_8win32service_8php_source.html#l00118">Win32Service\getVbsKeys()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../db/d83/class_8nssm_8php_source.html#l00348">Nssm\infos()</a>, and <a class="el" href="../../dc/db9/class_8win32service_8php_source.html#l00647">Win32Service\infos()</a>.</p>

</div>
</div>
<a id="a53925cff6048273f90461d3bc6aa4ac5" name="a53925cff6048273f90461d3bc6aa4ac5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a53925cff6048273f90461d3bc6aa4ac5">&#9670;&#160;</a></span>getSpecialPath()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">getSpecialPath </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$path</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Retrieves a special folder path.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$path</td><td>The VBScript path constant for the special folder.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>string|null The path to the special folder, or null on failure. </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d8/d62/class_8vbs_8php_source.html#l00275">275</a> of file <a class="el" href="../../d8/d62/class_8vbs_8php_source.html">class.vbs.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  276</span>    {</div>
<div class="line"><span class="lineno">  277</span>        $basename   = <span class="stringliteral">&#39;getSpecialPath&#39;</span>;</div>
<div class="line"><span class="lineno">  278</span>        $resultFile = <a class="code hl_function" href="#a2790ba3876c9f7f66ebec833eea82a2b">self::getResultFile</a>( $basename );</div>
<div class="line"><span class="lineno">  279</span> </div>
<div class="line"><span class="lineno">  280</span>        $content = <span class="stringliteral">&#39;Dim objShell, objFso, objResultFile&#39;</span> . PHP_EOL . PHP_EOL;</div>
<div class="line"><span class="lineno">  281</span>        $content .= <span class="stringliteral">&#39;Set objShell = Wscript.CreateObject(&quot;Wscript.Shell&quot;)&#39;</span> . PHP_EOL;</div>
<div class="line"><span class="lineno">  282</span>        $content .= <span class="stringliteral">&#39;Set objFso = CreateObject(&quot;scripting.filesystemobject&quot;)&#39;</span> . PHP_EOL;</div>
<div class="line"><span class="lineno">  283</span>        $content .= <span class="stringliteral">&#39;Set objResultFile = objFso.CreateTextFile(&quot;&#39;</span> . $resultFile . <span class="stringliteral">&#39;&quot;, True)&#39;</span> . PHP_EOL . PHP_EOL;</div>
<div class="line"><span class="lineno">  284</span>        $content .= <span class="stringliteral">&#39;objResultFile.WriteLine(&#39;</span> . $path . <span class="charliteral">&#39;)&#39;</span> . PHP_EOL;</div>
<div class="line"><span class="lineno">  285</span>        $content .= <span class="stringliteral">&#39;objResultFile.Close&#39;</span> . PHP_EOL;</div>
<div class="line"><span class="lineno">  286</span> </div>
<div class="line"><span class="lineno">  287</span>        <a class="code hl_variable" href="../../d4/d44/ajax_8apache_8php.html#a112ef069ddc0454086e3d1e6d8d55d07">$result</a> = <a class="code hl_function" href="#a5be68e999bf31b7f671054c54565b6a1">self::exec</a>( $basename, $resultFile, $content );</div>
<div class="line"><span class="lineno">  288</span>        <span class="keywordflow">if</span> ( !empty( <a class="code hl_variable" href="../../d4/d44/ajax_8apache_8php.html#a112ef069ddc0454086e3d1e6d8d55d07">$result</a> ) &amp;&amp; is_array( <a class="code hl_variable" href="../../d4/d44/ajax_8apache_8php.html#a112ef069ddc0454086e3d1e6d8d55d07">$result</a> ) &amp;&amp; count( <a class="code hl_variable" href="../../d4/d44/ajax_8apache_8php.html#a112ef069ddc0454086e3d1e6d8d55d07">$result</a> ) == 1 ) {</div>
<div class="line"><span class="lineno">  289</span>            <span class="keywordflow">return</span> <a class="code hl_function" href="../../d1/d0a/class_util.html#a9926f7e8c24507b7dea25e3343238a2f">Util::formatUnixPath</a>( <a class="code hl_variable" href="../../d4/d44/ajax_8apache_8php.html#a112ef069ddc0454086e3d1e6d8d55d07">$result</a>[0] );</div>
<div class="line"><span class="lineno">  290</span>        }</div>
<div class="line"><span class="lineno">  291</span> </div>
<div class="line"><span class="lineno">  292</span>        <span class="keywordflow">return</span> <span class="keyword">null</span>;</div>
<div class="line"><span class="lineno">  293</span>    }</div>
<div class="ttc" id="aclass_util_html_a9926f7e8c24507b7dea25e3343238a2f"><div class="ttname"><a href="../../d1/d0a/class_util.html#a9926f7e8c24507b7dea25e3343238a2f">Util\formatUnixPath</a></div><div class="ttdeci">static formatUnixPath($path)</div><div class="ttdef"><b>Definition</b> <a href="../../d5/d12/class_8util_8php_source.html#l00888">class.util.php:888</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d4/d44/ajax_8apache_8php_source.html#l00019">$result</a>, <a class="el" href="../../d8/d62/class_8vbs_8php_source.html#l00439">exec()</a>, <a class="el" href="../../d5/d12/class_8util_8php_source.html#l00888">Util\formatUnixPath()</a>, and <a class="el" href="../../d8/d62/class_8vbs_8php_source.html#l00424">getResultFile()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/d62/class_8vbs_8php_source.html#l00302">getStartupPath()</a>.</p>

</div>
</div>
<a id="afa896a018142f4d91a29b1cf67dbf51d" name="afa896a018142f4d91a29b1cf67dbf51d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afa896a018142f4d91a29b1cf67dbf51d">&#9670;&#160;</a></span>getStartupPath()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">getStartupPath </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$file</em></span><span class="paramdefsep"> = </span><span class="paramdefval">null</span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Retrieves the startup path, optionally appending a file name.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string&#160;|&#160;null</td><td class="paramname">$file</td><td>The file name to append to the startup path.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>string The startup path. </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d8/d62/class_8vbs_8php_source.html#l00302">302</a> of file <a class="el" href="../../d8/d62/class_8vbs_8php_source.html">class.vbs.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  303</span>    {</div>
<div class="line"><span class="lineno">  304</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="#a53925cff6048273f90461d3bc6aa4ac5">self::getSpecialPath</a>( self::STARTUP_PATH ) . ($file != <span class="keyword">null</span> ? <span class="charliteral">&#39;/&#39;</span> . $file : <span class="stringliteral">&#39;&#39;</span>);</div>
<div class="line"><span class="lineno">  305</span>    }</div>
<div class="ttc" id="aclass_vbs_html_a53925cff6048273f90461d3bc6aa4ac5"><div class="ttname"><a href="#a53925cff6048273f90461d3bc6aa4ac5">Vbs\getSpecialPath</a></div><div class="ttdeci">static getSpecialPath($path)</div><div class="ttdef"><b>Definition</b> <a href="../../d8/d62/class_8vbs_8php_source.html#l00275">class.vbs.php:275</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d8/d62/class_8vbs_8php_source.html#l00275">getSpecialPath()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/d12/class_8util_8php_source.html#l00619">Util\getStartupLnkPath()</a>.</p>

</div>
</div>
<a id="ac83f11b6ccf65f89682e269e9528a492" name="ac83f11b6ccf65f89682e269e9528a492"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac83f11b6ccf65f89682e269e9528a492">&#9670;&#160;</a></span>getTmpFile()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">getTmpFile </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$ext</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$customName</em></span><span class="paramdefsep"> = </span><span class="paramdefval">null</span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Generates a temporary file path with a given extension and optional custom name.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$ext</td><td>The file extension for the temporary file. </td></tr>
    <tr><td class="paramtype">string&#160;|&#160;null</td><td class="paramname">$customName</td><td>An optional custom name to include in the file name.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>string The formatted path to the temporary file. </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d8/d62/class_8vbs_8php_source.html#l00410">410</a> of file <a class="el" href="../../d8/d62/class_8vbs_8php_source.html">class.vbs.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  411</span>    {</div>
<div class="line"><span class="lineno">  412</span>        global <a class="code hl_variable" href="../../da/dd5/ajax_8latestversion_8php.html#adbfa2152f4bc29f5de1967eb55b09198">$bearsamppCore</a>;</div>
<div class="line"><span class="lineno">  413</span> </div>
<div class="line"><span class="lineno">  414</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="../../d1/d0a/class_util.html#a929ef14f32f27fe757b324a9791c1e92">Util::formatWindowsPath</a>( <a class="code hl_variable" href="../../da/dd5/ajax_8latestversion_8php.html#adbfa2152f4bc29f5de1967eb55b09198">$bearsamppCore</a>-&gt;getTmpPath() . <span class="charliteral">&#39;/&#39;</span> . (!empty( $customName ) ? $customName . <span class="charliteral">&#39;-&#39;</span> : <span class="stringliteral">&#39;&#39;</span>) . <a class="code hl_function" href="../../d1/d0a/class_util.html#a8947bb42d36178ac24f7f2168cdf7230">Util::random</a>() . $ext );</div>
<div class="line"><span class="lineno">  415</span>    }</div>
<div class="ttc" id="aclass_util_html_a929ef14f32f27fe757b324a9791c1e92"><div class="ttname"><a href="../../d1/d0a/class_util.html#a929ef14f32f27fe757b324a9791c1e92">Util\formatWindowsPath</a></div><div class="ttdeci">static formatWindowsPath($path)</div><div class="ttdef"><b>Definition</b> <a href="../../d5/d12/class_8util_8php_source.html#l00876">class.util.php:876</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aebc14ecd472e0982e772d53f02ffe220" name="aebc14ecd472e0982e772d53f02ffe220"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aebc14ecd472e0982e772d53f02ffe220">&#9670;&#160;</a></span>killProc()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">killProc </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$pid</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Terminates a process by its PID.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">int</td><td class="paramname">$pid</td><td>The process ID to terminate.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>bool True on success, false on failure. </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d8/d62/class_8vbs_8php_source.html#l00224">224</a> of file <a class="el" href="../../d8/d62/class_8vbs_8php_source.html">class.vbs.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  225</span>    {</div>
<div class="line"><span class="lineno">  226</span>        $basename   = <span class="stringliteral">&#39;killProc&#39;</span>;</div>
<div class="line"><span class="lineno">  227</span>        $resultFile = <a class="code hl_function" href="#a2790ba3876c9f7f66ebec833eea82a2b">self::getResultFile</a>( $basename );</div>
<div class="line"><span class="lineno">  228</span> </div>
<div class="line"><span class="lineno">  229</span>        $content = <span class="stringliteral">&#39;Dim objFso, objResultFile, objWMIService, processFound&#39;</span> . PHP_EOL . PHP_EOL;</div>
<div class="line"><span class="lineno">  230</span>        $content .= <span class="stringliteral">&#39;Set objFso = CreateObject(&quot;scripting.filesystemobject&quot;)&#39;</span> . PHP_EOL;</div>
<div class="line"><span class="lineno">  231</span>        $content .= <span class="stringliteral">&#39;Set objResultFile = objFso.CreateTextFile(&quot;&#39;</span> . $resultFile . <span class="stringliteral">&#39;&quot;, True)&#39;</span> . PHP_EOL;</div>
<div class="line"><span class="lineno">  232</span>        $content .= <span class="stringliteral">&#39;strComputer = &quot;.&quot;&#39;</span> . PHP_EOL;</div>
<div class="line"><span class="lineno">  233</span>        $content .= <span class="stringliteral">&#39;strProcessKill = &quot;&#39;</span> . $pid . <span class="charliteral">&#39;&quot;&#39;</span> . PHP_EOL;</div>
<div class="line"><span class="lineno">  234</span>        $content .= <span class="stringliteral">&#39;processFound = False&#39;</span> . PHP_EOL;</div>
<div class="line"><span class="lineno">  235</span>        $content .= <span class="stringliteral">&#39;Set objWMIService = GetObject(&quot;winmgmts:&quot; &amp; &quot;{impersonationLevel=impersonate}!\\\\&quot; &amp; strComputer &amp; &quot;\root\cimv2&quot;)&#39;</span> . PHP_EOL;</div>
<div class="line"><span class="lineno">  236</span>        $content .= <span class="stringliteral">&#39;Set listProcess = objWMIService.ExecQuery (&quot;Select * from Win32_Process Where ProcessID = &quot; &amp; strProcessKill)&#39;</span> . PHP_EOL;</div>
<div class="line"><span class="lineno">  237</span>        $content .= <span class="stringliteral">&#39;For Each objProcess in listProcess&#39;</span> . PHP_EOL;</div>
<div class="line"><span class="lineno">  238</span>        $content .= <span class="stringliteral">&#39;    processFound = True&#39;</span> . PHP_EOL;</div>
<div class="line"><span class="lineno">  239</span>        $content .= <span class="stringliteral">&#39;    objResultFile.WriteLine(objProcess.Name &amp; &quot;&#39;</span> . self::STR_SEPARATOR . <span class="stringliteral">&#39;&quot; &amp; objProcess.ProcessID &amp; &quot;&#39;</span> . self::STR_SEPARATOR . <span class="stringliteral">&#39;&quot; &amp; objProcess.ExecutablePath)&#39;</span> . PHP_EOL;</div>
<div class="line"><span class="lineno">  240</span>        $content .= <span class="stringliteral">&#39;    objProcess.Terminate()&#39;</span> . PHP_EOL;</div>
<div class="line"><span class="lineno">  241</span>        $content .= <span class="stringliteral">&#39;Next&#39;</span> . PHP_EOL;</div>
<div class="line"><span class="lineno">  242</span>        $content .= <span class="stringliteral">&#39;If Not processFound Then&#39;</span> . PHP_EOL;</div>
<div class="line"><span class="lineno">  243</span>        $content .= <span class="stringliteral">&#39;    objResultFile.WriteLine(&quot;PROCESS_NOT_FOUND&#39;</span> . self::STR_SEPARATOR . <span class="stringliteral">&#39;&quot; &amp; strProcessKill &amp; &quot;&#39;</span> . self::STR_SEPARATOR . <span class="stringliteral">&#39;&quot;)&#39;</span> . PHP_EOL;</div>
<div class="line"><span class="lineno">  244</span>        $content .= <span class="stringliteral">&#39;End If&#39;</span> . PHP_EOL;</div>
<div class="line"><span class="lineno">  245</span>        $content .= <span class="stringliteral">&#39;objResultFile.Close&#39;</span> . PHP_EOL;</div>
<div class="line"><span class="lineno">  246</span> </div>
<div class="line"><span class="lineno">  247</span>        <a class="code hl_variable" href="../../d4/d44/ajax_8apache_8php.html#a112ef069ddc0454086e3d1e6d8d55d07">$result</a> = <a class="code hl_function" href="#a5be68e999bf31b7f671054c54565b6a1">self::exec</a>( $basename, $resultFile, $content );</div>
<div class="line"><span class="lineno">  248</span>        <span class="keywordflow">if</span> ( empty( <a class="code hl_variable" href="../../d4/d44/ajax_8apache_8php.html#a112ef069ddc0454086e3d1e6d8d55d07">$result</a> ) ) {</div>
<div class="line"><span class="lineno">  249</span>            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  250</span>        }</div>
<div class="line"><span class="lineno">  251</span> </div>
<div class="line"><span class="lineno">  252</span>        <span class="keywordflow">if</span> ( is_array( <a class="code hl_variable" href="../../d4/d44/ajax_8apache_8php.html#a112ef069ddc0454086e3d1e6d8d55d07">$result</a> ) &amp;&amp; count( <a class="code hl_variable" href="../../d4/d44/ajax_8apache_8php.html#a112ef069ddc0454086e3d1e6d8d55d07">$result</a> ) &gt; 0 ) {</div>
<div class="line"><span class="lineno">  253</span>            <span class="keywordflow">foreach</span> ( <a class="code hl_variable" href="../../d4/d44/ajax_8apache_8php.html#a112ef069ddc0454086e3d1e6d8d55d07">$result</a> as $row ) {</div>
<div class="line"><span class="lineno">  254</span>                $row = explode( self::STR_SEPARATOR, $row );</div>
<div class="line"><span class="lineno">  255</span>                <span class="keywordflow">if</span> ( count( $row ) == 3 ) {</div>
<div class="line"><span class="lineno">  256</span>                    <span class="keywordflow">if</span> ( $row[0] === <span class="stringliteral">&#39;PROCESS_NOT_FOUND&#39;</span> ) {</div>
<div class="line"><span class="lineno">  257</span>                        <a class="code hl_function" href="../../d1/d0a/class_util.html#a708479f12c93bcadef186df397bbf049">Util::logDebug</a>( <span class="stringliteral">&#39;Process with PID &#39;</span> . $row[1] . <span class="stringliteral">&#39; not found&#39;</span> );</div>
<div class="line"><span class="lineno">  258</span>                    } elseif ( !empty( $row[2] ) ) {</div>
<div class="line"><span class="lineno">  259</span>                        <a class="code hl_function" href="../../d1/d0a/class_util.html#a708479f12c93bcadef186df397bbf049">Util::logDebug</a>( <span class="stringliteral">&#39;Kill process &#39;</span> . $row[2] . <span class="stringliteral">&#39; (PID &#39;</span> . $row[1] . <span class="charliteral">&#39;)&#39;</span> );</div>
<div class="line"><span class="lineno">  260</span>                    }</div>
<div class="line"><span class="lineno">  261</span>                }</div>
<div class="line"><span class="lineno">  262</span>            }</div>
<div class="line"><span class="lineno">  263</span>        }</div>
<div class="line"><span class="lineno">  264</span> </div>
<div class="line"><span class="lineno">  265</span>        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  266</span>    }</div>
<div class="ttc" id="aclass_util_html_a708479f12c93bcadef186df397bbf049"><div class="ttname"><a href="../../d1/d0a/class_util.html#a708479f12c93bcadef186df397bbf049">Util\logDebug</a></div><div class="ttdeci">static logDebug($data, $file=null)</div><div class="ttdef"><b>Definition</b> <a href="../../d5/d12/class_8util_8php_source.html#l00755">class.util.php:755</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d4/d44/ajax_8apache_8php_source.html#l00019">$result</a>, <a class="el" href="../../d8/d62/class_8vbs_8php_source.html#l00439">exec()</a>, <a class="el" href="../../d8/d62/class_8vbs_8php_source.html#l00424">getResultFile()</a>, and <a class="el" href="../../d5/d12/class_8util_8php_source.html#l00755">Util\logDebug()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d6/daa/class_8win32ps_8php_source.html#l00165">Win32Ps\kill()</a>, and <a class="el" href="../../d6/dd4/class_8action_8quit_8php_source.html#l00131">ActionQuit\terminatePhpProcesses()</a>.</p>

</div>
</div>
<a id="a1e3715665ded5e5e73e20916e669da29" name="a1e3715665ded5e5e73e20916e669da29"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1e3715665ded5e5e73e20916e669da29">&#9670;&#160;</a></span>writeLog()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">writeLog </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$log</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Writes a log entry to the VBS log file.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$log</td><td>The log message to write. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d8/d62/class_8vbs_8php_source.html#l00037">37</a> of file <a class="el" href="../../d8/d62/class_8vbs_8php_source.html">class.vbs.php</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   38</span>    {</div>
<div class="line"><span class="lineno">   39</span>        global <a class="code hl_variable" href="../../d4/d44/ajax_8apache_8php.html#a9f1773c8b2e8f420b90fe4cce25ff9cf">$bearsamppRoot</a>;</div>
<div class="line"><span class="lineno">   40</span>        <a class="code hl_function" href="../../d1/d0a/class_util.html#a708479f12c93bcadef186df397bbf049">Util::logDebug</a>( $log, <a class="code hl_variable" href="../../d4/d44/ajax_8apache_8php.html#a9f1773c8b2e8f420b90fe4cce25ff9cf">$bearsamppRoot</a>-&gt;getVbsLogFilePath() );</div>
<div class="line"><span class="lineno">   41</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d4/d44/ajax_8apache_8php_source.html#l00016">$bearsamppRoot</a>, and <a class="el" href="../../d5/d12/class_8util_8php_source.html#l00755">Util\logDebug()</a>.</p>

</div>
</div>
<a name="doc-variable-members" id="doc-variable-members"></a><h2 id="header-doc-variable-members" class="groupheader">Field Documentation</h2>
<a id="a56575463227295c2eb9e96538e874207" name="a56575463227295c2eb9e96538e874207"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a56575463227295c2eb9e96538e874207">&#9670;&#160;</a></span>ALL_DESKTOP_PATH</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const ALL_DESKTOP_PATH = 'objShell.SpecialFolders(&quot;AllUsersDesktop&quot;)'</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/d62/class_8vbs_8php_source.html#l00024">24</a> of file <a class="el" href="../../d8/d62/class_8vbs_8php_source.html">class.vbs.php</a>.</p>

</div>
</div>
<a id="ac13ae1a5af3c69138feec1408ac983e2" name="ac13ae1a5af3c69138feec1408ac983e2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac13ae1a5af3c69138feec1408ac983e2">&#9670;&#160;</a></span>ALL_STARTUP_PATH</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const ALL_STARTUP_PATH = 'objShell.SpecialFolders(&quot;AllUsersStartup&quot;)'</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/d62/class_8vbs_8php_source.html#l00026">26</a> of file <a class="el" href="../../d8/d62/class_8vbs_8php_source.html">class.vbs.php</a>.</p>

</div>
</div>
<a id="a8b5fceba526639344aec54e33c9fe838" name="a8b5fceba526639344aec54e33c9fe838"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8b5fceba526639344aec54e33c9fe838">&#9670;&#160;</a></span>DESKTOP_PATH</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const DESKTOP_PATH = 'objShell.SpecialFolders(&quot;Desktop&quot;)'</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/d62/class_8vbs_8php_source.html#l00023">23</a> of file <a class="el" href="../../d8/d62/class_8vbs_8php_source.html">class.vbs.php</a>.</p>

</div>
</div>
<a id="af5b7c5485cc0fb57776174544fed2823" name="af5b7c5485cc0fb57776174544fed2823"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af5b7c5485cc0fb57776174544fed2823">&#9670;&#160;</a></span>END_PROCESS_STR</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const END_PROCESS_STR = 'FINISHED!'</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/d62/class_8vbs_8php_source.html#l00020">20</a> of file <a class="el" href="../../d8/d62/class_8vbs_8php_source.html">class.vbs.php</a>.</p>

</div>
</div>
<a id="a54192de84d35d097a2d1ec81e5a2c704" name="a54192de84d35d097a2d1ec81e5a2c704"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a54192de84d35d097a2d1ec81e5a2c704">&#9670;&#160;</a></span>STARTUP_PATH</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const STARTUP_PATH = 'objShell.SpecialFolders(&quot;Startup&quot;)'</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/d62/class_8vbs_8php_source.html#l00025">25</a> of file <a class="el" href="../../d8/d62/class_8vbs_8php_source.html">class.vbs.php</a>.</p>

</div>
</div>
<a id="abcd066e2ac9191bca4dff9f4b39960c3" name="abcd066e2ac9191bca4dff9f4b39960c3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abcd066e2ac9191bca4dff9f4b39960c3">&#9670;&#160;</a></span>STR_SEPARATOR</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const STR_SEPARATOR = ' || '</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/d62/class_8vbs_8php_source.html#l00021">21</a> of file <a class="el" href="../../d8/d62/class_8vbs_8php_source.html">class.vbs.php</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>E:/Bearsampp-development/sandbox/core/classes/<a class="el" href="../../d8/d62/class_8vbs_8php_source.html">class.vbs.php</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<div id="page-nav" class="page-nav-panel">
<div id="page-nav-resize-handle"></div>
<div id="page-nav-tree">
<div id="page-nav-contents">
</div><!-- page-nav-contents -->
</div><!-- page-nav-tree -->
</div><!-- page-nav -->
</div><!-- container -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a href="../../d5/dbc/class_vbs.html">Vbs</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.14.0 </li>
  </ul>
</div>
</body>
</html>
