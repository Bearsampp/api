\doxysection{class.\+module.\+php}
\label{class_8module_8php_source}\index{E:/Bearsampp-\/development/sandbox/core/classes/class.module.php@{E:/Bearsampp-\/development/sandbox/core/classes/class.module.php}}
\textbf{ Go to the documentation of this file.}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ <?php}
\DoxyCodeLine{00002\ \textcolor{comment}{/*}}
\DoxyCodeLine{00003\ \textcolor{comment}{\ *\ Copyright\ (c)\ 2021-\/2024\ Bearsampp}}
\DoxyCodeLine{00004\ \textcolor{comment}{\ *\ License:\ \ GNU\ General\ Public\ License\ version\ 3\ or\ later;\ see\ LICENSE.txt}}
\DoxyCodeLine{00005\ \textcolor{comment}{\ *\ Author:\ Bear}}
\DoxyCodeLine{00006\ \textcolor{comment}{\ *\ Website:\ https://bearsampp.com}}
\DoxyCodeLine{00007\ \textcolor{comment}{\ *\ Github:\ https://github.com/Bearsampp}}
\DoxyCodeLine{00008\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00009\ }
\DoxyCodeLine{00014\ \textcolor{keyword}{abstract}\ \textcolor{keyword}{class\ }Module}
\DoxyCodeLine{00015\ \{}
\DoxyCodeLine{00016\ \ \ \ \ \textcolor{keyword}{const}\ BUNDLE\_RELEASE\ =\ \textcolor{stringliteral}{'bundleRelease'};}
\DoxyCodeLine{00017\ }
\DoxyCodeLine{00018\ \ \ \ \ \textcolor{keyword}{private}\ \$type;}
\DoxyCodeLine{00019\ \ \ \ \ \textcolor{keyword}{private}\ \$id;}
\DoxyCodeLine{00020\ }
\DoxyCodeLine{00021\ \ \ \ \ \textcolor{keyword}{protected}\ \$name;}
\DoxyCodeLine{00022\ \ \ \ \ \textcolor{keyword}{protected}\ \$version;}
\DoxyCodeLine{00023\ \ \ \ \ \textcolor{keyword}{protected}\ \$release\ =\ \textcolor{stringliteral}{'N/A'};}
\DoxyCodeLine{00024\ }
\DoxyCodeLine{00025\ \ \ \ \ \textcolor{keyword}{protected}\ \$rootPath;}
\DoxyCodeLine{00026\ \ \ \ \ \textcolor{keyword}{protected}\ \$currentPath;}
\DoxyCodeLine{00027\ \ \ \ \ \textcolor{keyword}{protected}\ \$symlinkPath;}
\DoxyCodeLine{00028\ \ \ \ \ \textcolor{keyword}{protected}\ \$enable;}
\DoxyCodeLine{00029\ \ \ \ \ \textcolor{keyword}{protected}\ \$bearsamppConf;}
\DoxyCodeLine{00030\ \ \ \ \ \textcolor{keyword}{protected}\ \$bearsamppConfRaw;}
\DoxyCodeLine{00031\ }
\DoxyCodeLine{00036\ \ \ \ \ \textcolor{keyword}{protected}\ \textcolor{keyword}{function}\ \_\_construct()\ \{}
\DoxyCodeLine{00037\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Initialization\ logic\ can\ be\ added\ here\ if\ needed}}
\DoxyCodeLine{00038\ \ \ \ \ \}}
\DoxyCodeLine{00039\ }
\DoxyCodeLine{00046\ \ \ \ \ \textcolor{keyword}{protected}\ \textcolor{keyword}{function}\ reload(\$id\ =\ \textcolor{keyword}{null},\ \$type\ =\ \textcolor{keyword}{null})\ \{}
\DoxyCodeLine{00047\ \ \ \ \ \ \ \ \ global\ \$bearsamppRoot;}
\DoxyCodeLine{00048\ }
\DoxyCodeLine{00049\ \ \ \ \ \ \ \ \ \$this-\/>\textcolor{keywordtype}{id}\ =\ empty(\$id)\ ?\ \$this-\/>id\ :\ \$id;}
\DoxyCodeLine{00050\ \ \ \ \ \ \ \ \ \$this-\/>type\ =\ empty(\$type)\ ?\ \$this-\/>type\ :\ \$type;}
\DoxyCodeLine{00051\ \ \ \ \ \ \ \ \ \$mainPath\ =\ \textcolor{stringliteral}{'N/A'};}
\DoxyCodeLine{00052\ }
\DoxyCodeLine{00053\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{switch}\ (\$this-\/>type)\ \{}
\DoxyCodeLine{00054\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ Apps::TYPE:}
\DoxyCodeLine{00055\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$mainPath\ =\ \$bearsamppRoot-\/>getAppsPath();}
\DoxyCodeLine{00056\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00057\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ Bins::TYPE:}
\DoxyCodeLine{00058\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$mainPath\ =\ \$bearsamppRoot-\/>getBinPath();}
\DoxyCodeLine{00059\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00060\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ Tools::TYPE:}
\DoxyCodeLine{00061\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$mainPath\ =\ \$bearsamppRoot-\/>getToolsPath();}
\DoxyCodeLine{00062\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00063\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00064\ }
\DoxyCodeLine{00065\ \ \ \ \ \ \ \ \ \$this-\/>rootPath\ =\ \$mainPath\ .\ \textcolor{charliteral}{'/'}\ .\ \$this-\/>id;}
\DoxyCodeLine{00066\ \ \ \ \ \ \ \ \ \$this-\/>currentPath\ =\ \$this-\/>rootPath\ .\ \textcolor{charliteral}{'/'}\ .\ \$this-\/>\textcolor{keywordtype}{id}\ .\ \$this-\/>version;}
\DoxyCodeLine{00067\ \ \ \ \ \ \ \ \ \$this-\/>symlinkPath\ =\ \$this-\/>rootPath\ .\ \textcolor{stringliteral}{'/current'};}
\DoxyCodeLine{00068\ \ \ \ \ \ \ \ \ \$this-\/>enable\ =\ is\_dir(\$this-\/>currentPath);}
\DoxyCodeLine{00069\ \ \ \ \ \ \ \ \ \$this-\/>bearsamppConf\ =\ \$this-\/>currentPath\ .\ \textcolor{stringliteral}{'/bearsampp.conf'};}
\DoxyCodeLine{00070\ \ \ \ \ \ \ \ \ \$this-\/>bearsamppConfRaw\ =\ @parse\_ini\_file(\$this-\/>bearsamppConf);}
\DoxyCodeLine{00071\ }
\DoxyCodeLine{00072\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\$bearsamppRoot-\/>isRoot())\ \{}
\DoxyCodeLine{00073\ \ \ \ \ \ \ \ \ \ \ \ \ \$this-\/>createSymlink();}
\DoxyCodeLine{00074\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00075\ \ \ \ \ \}}
\DoxyCodeLine{00076\ }
\DoxyCodeLine{00081\ \ \ \ \ \textcolor{keyword}{private}\ \textcolor{keyword}{function}\ createSymlink()}
\DoxyCodeLine{00082\ \ \ \ \ \{}
\DoxyCodeLine{00083\ \ \ \ \ \ \ \ \ \$src\ =\ Util::formatWindowsPath(\$this-\/>currentPath);}
\DoxyCodeLine{00084\ \ \ \ \ \ \ \ \ \$dest\ =\ Util::formatWindowsPath(\$this-\/>symlinkPath);}
\DoxyCodeLine{00085\ }
\DoxyCodeLine{00086\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(file\_exists(\$dest))\ \{}
\DoxyCodeLine{00087\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (is\_link(\$dest))\ \{}
\DoxyCodeLine{00088\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$target\ =\ readlink(\$dest);}
\DoxyCodeLine{00089\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\$target\ ==\ \$src)\ \{}
\DoxyCodeLine{00090\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00091\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00092\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Batch::removeSymlink(\$dest);}
\DoxyCodeLine{00093\ \ \ \ \ \ \ \ \ \ \ \ \ \}\ elseif\ (is\_file(\$dest))\ \{}
\DoxyCodeLine{00094\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Util::logError(\textcolor{stringliteral}{'Removing\ .\ '}\ .\ \$this-\/>symlinkPath\ .\ \textcolor{stringliteral}{'\ file.\ It\ should\ not\ be\ a\ regular\ file'});}
\DoxyCodeLine{00095\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ unlink(\$dest);}
\DoxyCodeLine{00096\ \ \ \ \ \ \ \ \ \ \ \ \ \}\ elseif\ (is\_dir(\$dest))\ \{}
\DoxyCodeLine{00097\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!(\textcolor{keyword}{new}\ \(\backslash\)FilesystemIterator(\$dest))-\/>valid())\ \{}
\DoxyCodeLine{00098\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ rmdir(\$dest);}
\DoxyCodeLine{00099\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00100\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Util::logError(\$this-\/>symlinkPath\ .\ \textcolor{stringliteral}{'\ should\ be\ a\ symlink\ to\ '}\ .\ \$this-\/>currentPath\ .\ \textcolor{stringliteral}{'.\ Please\ remove\ this\ dir\ and\ restart\ bearsampp.'});}
\DoxyCodeLine{00101\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00102\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00103\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00104\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00105\ }
\DoxyCodeLine{00106\ \ \ \ \ \ \ \ \ Batch::createSymlink(\$src,\ \$dest);}
\DoxyCodeLine{00107\ \ \ \ \ \}}
\DoxyCodeLine{00108\ }
\DoxyCodeLine{00115\ \ \ \ \ \textcolor{keyword}{protected}\ \textcolor{keyword}{function}\ replace(\$key,\ \$value)\ \{}
\DoxyCodeLine{00116\ \ \ \ \ \ \ \ \ \$this-\/>replaceAll(array(\$key\ =>\ \$value));}
\DoxyCodeLine{00117\ \ \ \ \ \}}
\DoxyCodeLine{00118\ }
\DoxyCodeLine{00124\ \ \ \ \ \textcolor{keyword}{protected}\ \textcolor{keyword}{function}\ replaceAll(\$params)\ \{}
\DoxyCodeLine{00125\ \ \ \ \ \ \ \ \ \$content\ =\ file\_get\_contents(\$this-\/>bearsamppConf);}
\DoxyCodeLine{00126\ }
\DoxyCodeLine{00127\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{foreach}\ (\$params\ as\ \$key\ =>\ \$value)\ \{}
\DoxyCodeLine{00128\ \ \ \ \ \ \ \ \ \ \ \ \ \$content\ =\ preg\_replace(\textcolor{charliteral}{'|'}\ .\ \$key\ .\ \textcolor{stringliteral}{'\ =\ .*|'},\ \$key\ .\ \textcolor{stringliteral}{'\ =\ '}\ .\ \textcolor{charliteral}{'"{}'}\ .\ \$value.\textcolor{charliteral}{'"{}'},\ \$content);}
\DoxyCodeLine{00129\ \ \ \ \ \ \ \ \ \ \ \ \ \$this-\/>bearsamppConfRaw[\$key]\ =\ \$value;}
\DoxyCodeLine{00130\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00131\ }
\DoxyCodeLine{00132\ \ \ \ \ \ \ \ \ file\_put\_contents(\$this-\/>bearsamppConf,\ \$content);}
\DoxyCodeLine{00133\ \ \ \ \ \}}
\DoxyCodeLine{00134\ }
\DoxyCodeLine{00141\ \ \ \ \ \textcolor{keyword}{public}\ \textcolor{keyword}{function}\ update(\$sub\ =\ 0,\ \$showWindow\ =\ \textcolor{keyword}{false})\ \{}
\DoxyCodeLine{00142\ \ \ \ \ \ \ \ \ \$this-\/>updateConfig(\textcolor{keyword}{null},\ \$sub,\ \$showWindow);}
\DoxyCodeLine{00143\ \ \ \ \ \}}
\DoxyCodeLine{00144\ }
\DoxyCodeLine{00152\ \ \ \ \ \textcolor{keyword}{protected}\ \textcolor{keyword}{function}\ updateConfig(\$version\ =\ \textcolor{keyword}{null},\ \$sub\ =\ 0,\ \$showWindow\ =\ \textcolor{keyword}{false})\ \{}
\DoxyCodeLine{00153\ \ \ \ \ \ \ \ \ \$version\ =\ \$version\ ==\ \textcolor{keyword}{null}\ ?\ \$this-\/>version\ :\ \$version;}
\DoxyCodeLine{00154\ \ \ \ \ \ \ \ \ Util::logDebug((\$sub\ >\ 0\ ?\ str\_repeat(\textcolor{charliteral}{'\ '},\ 2\ *\ \$sub)\ :\ \textcolor{stringliteral}{''})\ .\ \textcolor{stringliteral}{'Update\ '}\ .\ \$this-\/>name\ .\ \textcolor{charliteral}{'\ '}\ .\ \$version\ .\ \textcolor{stringliteral}{'\ config'});}
\DoxyCodeLine{00155\ \ \ \ \ \}}
\DoxyCodeLine{00156\ }
\DoxyCodeLine{00162\ \ \ \ \ \textcolor{keyword}{public}\ \textcolor{keyword}{function}\ \_\_toString()\ \{}
\DoxyCodeLine{00163\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \$this-\/>getName();}
\DoxyCodeLine{00164\ \ \ \ \ \}}
\DoxyCodeLine{00165\ }
\DoxyCodeLine{00171\ \ \ \ \ \textcolor{keyword}{public}\ \textcolor{keyword}{function}\ getType()\ \{}
\DoxyCodeLine{00172\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \$this-\/>type;}
\DoxyCodeLine{00173\ \ \ \ \ \}}
\DoxyCodeLine{00174\ }
\DoxyCodeLine{00180\ \ \ \ \ \textcolor{keyword}{public}\ \textcolor{keyword}{function}\ getId()\ \{}
\DoxyCodeLine{00181\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \$this-\/>id;}
\DoxyCodeLine{00182\ \ \ \ \ \}}
\DoxyCodeLine{00183\ }
\DoxyCodeLine{00189\ \ \ \ \ \textcolor{keyword}{public}\ \textcolor{keyword}{function}\ getName()\ \{}
\DoxyCodeLine{00190\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \$this-\/>name;}
\DoxyCodeLine{00191\ \ \ \ \ \}}
\DoxyCodeLine{00192\ }
\DoxyCodeLine{00198\ \ \ \ \ \textcolor{keyword}{public}\ \textcolor{keyword}{function}\ getVersion()\ \{}
\DoxyCodeLine{00199\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \$this-\/>version;}
\DoxyCodeLine{00200\ \ \ \ \ \}}
\DoxyCodeLine{00201\ }
\DoxyCodeLine{00207\ \ \ \ \ \textcolor{keyword}{public}\ \textcolor{keyword}{function}\ getVersionList()\ \{}
\DoxyCodeLine{00208\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ Util::getVersionList(\$this-\/>rootPath);}
\DoxyCodeLine{00209\ \ \ \ \ \}}
\DoxyCodeLine{00210\ }
\DoxyCodeLine{00216\ \ \ \ \ \textcolor{keyword}{abstract}\ \textcolor{keyword}{public}\ \textcolor{keyword}{function}\ setVersion(\$version);}
\DoxyCodeLine{00217\ }
\DoxyCodeLine{00223\ \ \ \ \ \textcolor{keyword}{public}\ \textcolor{keyword}{function}\ getRelease()\ \{}
\DoxyCodeLine{00224\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \$this-\/>release;}
\DoxyCodeLine{00225\ \ \ \ \ \}}
\DoxyCodeLine{00226\ }
\DoxyCodeLine{00232\ \ \ \ \ \textcolor{keyword}{public}\ \textcolor{keyword}{function}\ getRootPath()\ \{}
\DoxyCodeLine{00233\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \$this-\/>rootPath;}
\DoxyCodeLine{00234\ \ \ \ \ \}}
\DoxyCodeLine{00235\ }
\DoxyCodeLine{00241\ \ \ \ \ \textcolor{keyword}{public}\ \textcolor{keyword}{function}\ getCurrentPath()\ \{}
\DoxyCodeLine{00242\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \$this-\/>currentPath;}
\DoxyCodeLine{00243\ \ \ \ \ \}}
\DoxyCodeLine{00244\ }
\DoxyCodeLine{00250\ \ \ \ \ \textcolor{keyword}{public}\ \textcolor{keyword}{function}\ getSymlinkPath()\ \{}
\DoxyCodeLine{00251\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \$this-\/>symlinkPath;}
\DoxyCodeLine{00252\ \ \ \ \ \}}
\DoxyCodeLine{00253\ }
\DoxyCodeLine{00259\ \ \ \ \ \textcolor{keyword}{public}\ \textcolor{keyword}{function}\ isEnable()\ \{}
\DoxyCodeLine{00260\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \$this-\/>enable;}
\DoxyCodeLine{00261\ \ \ \ \ \}}
\DoxyCodeLine{00262\ \}}

\end{DoxyCode}
