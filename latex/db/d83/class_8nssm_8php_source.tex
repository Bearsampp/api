\doxysection{class.\+nssm.\+php}
\label{class_8nssm_8php_source}\index{E:/Bearsampp-\/development/sandbox/core/classes/class.nssm.php@{E:/Bearsampp-\/development/sandbox/core/classes/class.nssm.php}}
\textbf{ Go to the documentation of this file.}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ <?php}
\DoxyCodeLine{00002\ \textcolor{comment}{/*}}
\DoxyCodeLine{00003\ \textcolor{comment}{\ *\ Copyright\ (c)\ 2021-\/2024\ Bearsampp}}
\DoxyCodeLine{00004\ \textcolor{comment}{\ *\ License:\ \ GNU\ General\ Public\ License\ version\ 3\ or\ later;\ see\ LICENSE.txt}}
\DoxyCodeLine{00005\ \textcolor{comment}{\ *\ Author:\ Bear}}
\DoxyCodeLine{00006\ \textcolor{comment}{\ *\ Website:\ https://bearsampp.com}}
\DoxyCodeLine{00007\ \textcolor{comment}{\ *\ Github:\ https://github.com/Bearsampp}}
\DoxyCodeLine{00008\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00009\ }
\DoxyCodeLine{00017\ \textcolor{keyword}{class\ }Nssm}
\DoxyCodeLine{00018\ \{}
\DoxyCodeLine{00019\ \ \ \ \ \textcolor{comment}{//\ Start\ params}}
\DoxyCodeLine{00020\ \ \ \ \ \textcolor{keyword}{const}\ SERVICE\_AUTO\_START\ =\ \textcolor{stringliteral}{'SERVICE\_AUTO\_START'};}
\DoxyCodeLine{00021\ \ \ \ \ \textcolor{keyword}{const}\ SERVICE\_DELAYED\_START\ =\ \textcolor{stringliteral}{'SERVICE\_DELAYED\_START'};}
\DoxyCodeLine{00022\ \ \ \ \ \textcolor{keyword}{const}\ SERVICE\_DEMAND\_START\ =\ \textcolor{stringliteral}{'SERVICE\_DEMAND\_START'};}
\DoxyCodeLine{00023\ \ \ \ \ \textcolor{keyword}{const}\ SERVICE\_DISABLED\ =\ \textcolor{stringliteral}{'SERVICE\_DISABLED'};}
\DoxyCodeLine{00024\ }
\DoxyCodeLine{00025\ \ \ \ \ \textcolor{comment}{//\ Type\ params}}
\DoxyCodeLine{00026\ \ \ \ \ \textcolor{keyword}{const}\ SERVICE\_WIN32\_OWN\_PROCESS\ =\ \textcolor{stringliteral}{'SERVICE\_WIN32\_OWN\_PROCESS'};}
\DoxyCodeLine{00027\ \ \ \ \ \textcolor{keyword}{const}\ SERVICE\_INTERACTIVE\_PROCESS\ =\ \textcolor{stringliteral}{'SERVICE\_INTERACTIVE\_PROCESS'};}
\DoxyCodeLine{00028\ }
\DoxyCodeLine{00029\ \ \ \ \ \textcolor{comment}{//\ Status}}
\DoxyCodeLine{00030\ \ \ \ \ \textcolor{keyword}{const}\ STATUS\_CONTINUE\_PENDING\ =\ \textcolor{stringliteral}{'SERVICE\_CONTINUE\_PENDING'};}
\DoxyCodeLine{00031\ \ \ \ \ \textcolor{keyword}{const}\ STATUS\_PAUSE\_PENDING\ =\ \textcolor{stringliteral}{'SERVICE\_PAUSE\_PENDING'};}
\DoxyCodeLine{00032\ \ \ \ \ \textcolor{keyword}{const}\ STATUS\_PAUSED\ =\ \textcolor{stringliteral}{'SERVICE\_PAUSED'};}
\DoxyCodeLine{00033\ \ \ \ \ \textcolor{keyword}{const}\ STATUS\_RUNNING\ =\ \textcolor{stringliteral}{'SERVICE\_RUNNING'};}
\DoxyCodeLine{00034\ \ \ \ \ \textcolor{keyword}{const}\ STATUS\_START\_PENDING\ =\ \textcolor{stringliteral}{'SERVICE\_START\_PENDING'};}
\DoxyCodeLine{00035\ \ \ \ \ \textcolor{keyword}{const}\ STATUS\_STOP\_PENDING\ =\ \textcolor{stringliteral}{'SERVICE\_STOP\_PENDING'};}
\DoxyCodeLine{00036\ \ \ \ \ \textcolor{keyword}{const}\ STATUS\_STOPPED\ =\ \textcolor{stringliteral}{'SERVICE\_STOPPED'};}
\DoxyCodeLine{00037\ \ \ \ \ \textcolor{keyword}{const}\ STATUS\_NOT\_EXIST\ =\ \textcolor{stringliteral}{'SERVICE\_NOT\_EXIST'};}
\DoxyCodeLine{00038\ \ \ \ \ \textcolor{keyword}{const}\ STATUS\_NA\ =\ \textcolor{stringliteral}{'-\/1'};}
\DoxyCodeLine{00039\ }
\DoxyCodeLine{00040\ \ \ \ \ \textcolor{comment}{//\ Infos\ keys}}
\DoxyCodeLine{00041\ \ \ \ \ \textcolor{keyword}{const}\ INFO\_APP\_DIRECTORY\ =\ \textcolor{stringliteral}{'AppDirectory'};}
\DoxyCodeLine{00042\ \ \ \ \ \textcolor{keyword}{const}\ INFO\_APPLICATION\ =\ \textcolor{stringliteral}{'Application'};}
\DoxyCodeLine{00043\ \ \ \ \ \textcolor{keyword}{const}\ INFO\_APP\_PARAMETERS\ =\ \textcolor{stringliteral}{'AppParameters'};}
\DoxyCodeLine{00044\ \ \ \ \ \textcolor{keyword}{const}\ INFO\_APP\_STDERR\ =\ \textcolor{stringliteral}{'AppStderr'};}
\DoxyCodeLine{00045\ \ \ \ \ \textcolor{keyword}{const}\ INFO\_APP\_STDOUT\ =\ \textcolor{stringliteral}{'AppStdout'};}
\DoxyCodeLine{00046\ \ \ \ \ \textcolor{keyword}{const}\ INFO\_APP\_ENVIRONMENT\_EXTRA\ =\ \textcolor{stringliteral}{'AppEnvironmentExtra'};}
\DoxyCodeLine{00047\ }
\DoxyCodeLine{00048\ \ \ \ \ \textcolor{keyword}{const}\ PENDING\_TIMEOUT\ =\ 10;}
\DoxyCodeLine{00049\ \ \ \ \ \textcolor{keyword}{const}\ SLEEP\_TIME\ =\ 500000;}
\DoxyCodeLine{00050\ }
\DoxyCodeLine{00051\ \ \ \ \ \textcolor{keyword}{private}\ \$name;}
\DoxyCodeLine{00052\ \ \ \ \ \textcolor{keyword}{private}\ \$displayName;}
\DoxyCodeLine{00053\ \ \ \ \ \textcolor{keyword}{private}\ \$binPath;}
\DoxyCodeLine{00054\ \ \ \ \ \textcolor{keyword}{private}\ \$params;}
\DoxyCodeLine{00055\ \ \ \ \ \textcolor{keyword}{private}\ \$start;}
\DoxyCodeLine{00056\ \ \ \ \ \textcolor{keyword}{private}\ \$stdout;}
\DoxyCodeLine{00057\ \ \ \ \ \textcolor{keyword}{private}\ \$stderr;}
\DoxyCodeLine{00058\ \ \ \ \ \textcolor{keyword}{private}\ \$environmentExtra;}
\DoxyCodeLine{00059\ \ \ \ \ \textcolor{keyword}{private}\ \$latestError;}
\DoxyCodeLine{00060\ \ \ \ \ \textcolor{keyword}{private}\ \$latestStatus;}
\DoxyCodeLine{00061\ }
\DoxyCodeLine{00068\ \ \ \ \ \textcolor{keyword}{public}\ \textcolor{keyword}{function}\ \_\_construct(\$name)}
\DoxyCodeLine{00069\ \ \ \ \ \{}
\DoxyCodeLine{00070\ \ \ \ \ \ \ \ \ Util::logInitClass(\ \$this\ );}
\DoxyCodeLine{00071\ \ \ \ \ \ \ \ \ \$this-\/>name\ =\ \$name;}
\DoxyCodeLine{00072\ \ \ \ \ \}}
\DoxyCodeLine{00073\ }
\DoxyCodeLine{00079\ \ \ \ \ \textcolor{keyword}{private}\ \textcolor{keyword}{function}\ writeLog(\$log)}
\DoxyCodeLine{00080\ \ \ \ \ \{}
\DoxyCodeLine{00081\ \ \ \ \ \ \ \ \ global\ \$bearsamppRoot;}
\DoxyCodeLine{00082\ \ \ \ \ \ \ \ \ Util::logDebug(\ \$log,\ \$bearsamppRoot-\/>getNssmLogFilePath()\ );}
\DoxyCodeLine{00083\ \ \ \ \ \}}
\DoxyCodeLine{00084\ }
\DoxyCodeLine{00090\ \ \ \ \ \textcolor{keyword}{private}\ \textcolor{keyword}{function}\ writeLogInfo(\$log)}
\DoxyCodeLine{00091\ \ \ \ \ \{}
\DoxyCodeLine{00092\ \ \ \ \ \ \ \ \ global\ \$bearsamppRoot;}
\DoxyCodeLine{00093\ \ \ \ \ \ \ \ \ Util::logInfo(\ \$log,\ \$bearsamppRoot-\/>getNssmLogFilePath()\ );}
\DoxyCodeLine{00094\ \ \ \ \ \}}
\DoxyCodeLine{00095\ }
\DoxyCodeLine{00101\ \ \ \ \ \textcolor{keyword}{private}\ \textcolor{keyword}{function}\ writeLogError(\$log)}
\DoxyCodeLine{00102\ \ \ \ \ \{}
\DoxyCodeLine{00103\ \ \ \ \ \ \ \ \ global\ \$bearsamppRoot;}
\DoxyCodeLine{00104\ \ \ \ \ \ \ \ \ Util::logError(\ \$log,\ \$bearsamppRoot-\/>getNssmLogFilePath()\ );}
\DoxyCodeLine{00105\ \ \ \ \ \}}
\DoxyCodeLine{00106\ }
\DoxyCodeLine{00114\ \ \ \ \ \textcolor{keyword}{private}\ \textcolor{keyword}{function}\ exec(\$args)}
\DoxyCodeLine{00115\ \ \ \ \ \{}
\DoxyCodeLine{00116\ \ \ \ \ \ \ \ \ global\ \$bearsamppCore;}
\DoxyCodeLine{00117\ }
\DoxyCodeLine{00118\ \ \ \ \ \ \ \ \ \$command\ =\ \textcolor{charliteral}{'"{}'}\ .\ \$bearsamppCore-\/>getNssmExe()\ .\ \textcolor{stringliteral}{'"{}\ '}\ .\ \$args;}
\DoxyCodeLine{00119\ \ \ \ \ \ \ \ \ \$this-\/>writeLogInfo(\ \textcolor{stringliteral}{'Cmd:\ '}\ .\ \$command\ );}
\DoxyCodeLine{00120\ }
\DoxyCodeLine{00121\ \ \ \ \ \ \ \ \ \$result\ =\ Batch::exec(\ \textcolor{stringliteral}{'nssm'},\ \$command,\ 10\ );}
\DoxyCodeLine{00122\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\ is\_array(\ \$result\ )\ )\ \{}
\DoxyCodeLine{00123\ \ \ \ \ \ \ \ \ \ \ \ \ \$rebuildResult\ =\ array();}
\DoxyCodeLine{00124\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{foreach}\ (\ \$result\ as\ \$row\ )\ \{}
\DoxyCodeLine{00125\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$row\ =\ trim(\ \$row\ );}
\DoxyCodeLine{00126\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\ !empty(\ \$row\ )\ )\ \{}
\DoxyCodeLine{00127\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$rebuildResult[]\ =\ preg\_replace(\ \textcolor{stringliteral}{'/[\(\backslash\)x00-\/\(\backslash\)x1F\(\backslash\)x80-\/\(\backslash\)xFF]/'},\ \textcolor{stringliteral}{''},\ \$row\ );}
\DoxyCodeLine{00128\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00129\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00130\ \ \ \ \ \ \ \ \ \ \ \ \ \$result\ =\ \$rebuildResult;}
\DoxyCodeLine{00131\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\ count(\ \$result\ )\ >\ 1\ )\ \{}
\DoxyCodeLine{00132\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$this-\/>latestError\ =\ implode(\ \textcolor{stringliteral}{'\ ;\ '},\ \$result\ );}
\DoxyCodeLine{00133\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00134\ }
\DoxyCodeLine{00135\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \$result;}
\DoxyCodeLine{00136\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00137\ }
\DoxyCodeLine{00138\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00139\ \ \ \ \ \}}
\DoxyCodeLine{00140\ }
\DoxyCodeLine{00148\ \ \ \ \ \textcolor{keyword}{public}\ \textcolor{keyword}{function}\ status(\$timeout\ =\ \textcolor{keyword}{true})}
\DoxyCodeLine{00149\ \ \ \ \ \{}
\DoxyCodeLine{00150\ \ \ \ \ \ \ \ \ usleep(\ self::SLEEP\_TIME\ );}
\DoxyCodeLine{00151\ }
\DoxyCodeLine{00152\ \ \ \ \ \ \ \ \ \$this-\/>latestStatus\ =\ self::STATUS\_NA;}
\DoxyCodeLine{00153\ \ \ \ \ \ \ \ \ \$maxtime\ \ \ \ \ \ \ \ \ \ \ \ =\ time()\ +\ self::PENDING\_TIMEOUT;}
\DoxyCodeLine{00154\ }
\DoxyCodeLine{00155\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{while}\ (\ \$this-\/>latestStatus\ ==\ self::STATUS\_NA\ ||\ \$this-\/>isPending(\ \$this-\/>latestStatus\ )\ )\ \{}
\DoxyCodeLine{00156\ \ \ \ \ \ \ \ \ \ \ \ \ \$exec\ =\ \$this-\/>exec(\ \textcolor{stringliteral}{'status\ '}\ .\ \$this-\/>getName()\ );}
\DoxyCodeLine{00157\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\ \$exec\ !==\ \textcolor{keyword}{false}\ )\ \{}
\DoxyCodeLine{00158\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\ count(\ \$exec\ )\ >\ 1\ )\ \{}
\DoxyCodeLine{00159\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$this-\/>latestStatus\ =\ self::STATUS\_NOT\_EXIST;}
\DoxyCodeLine{00160\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00161\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00162\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$this-\/>latestStatus\ =\ \$exec[0];}
\DoxyCodeLine{00163\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00164\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00165\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\ \$timeout\ \&\&\ \$maxtime\ <\ time()\ )\ \{}
\DoxyCodeLine{00166\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00167\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00168\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00169\ }
\DoxyCodeLine{00170\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\ \$this-\/>latestStatus\ ==\ self::STATUS\_NOT\_EXIST\ )\ \{}
\DoxyCodeLine{00171\ \ \ \ \ \ \ \ \ \ \ \ \ \$this-\/>latestError\ \ =\ \textcolor{stringliteral}{'Error\ 3:\ The\ specified\ service\ does\ not\ exist\ as\ an\ installed\ service.'};}
\DoxyCodeLine{00172\ \ \ \ \ \ \ \ \ \ \ \ \ \$this-\/>latestStatus\ =\ self::STATUS\_NA;}
\DoxyCodeLine{00173\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00174\ }
\DoxyCodeLine{00175\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \$this-\/>latestStatus;}
\DoxyCodeLine{00176\ \ \ \ \ \}}
\DoxyCodeLine{00177\ }
\DoxyCodeLine{00183\ \ \ \ \ \textcolor{keyword}{public}\ \textcolor{keyword}{function}\ create()}
\DoxyCodeLine{00184\ \ \ \ \ \{}
\DoxyCodeLine{00185\ \ \ \ \ \ \ \ \ \$this-\/>writeLog(\ \textcolor{stringliteral}{'Create\ service'}\ );}
\DoxyCodeLine{00186\ \ \ \ \ \ \ \ \ \$this-\/>writeLog(\ \textcolor{stringliteral}{'-\/>\ service:\ '}\ .\ \$this-\/>getName()\ );}
\DoxyCodeLine{00187\ \ \ \ \ \ \ \ \ \$this-\/>writeLog(\ \textcolor{stringliteral}{'-\/>\ display:\ '}\ .\ \$this-\/>getDisplayName()\ );}
\DoxyCodeLine{00188\ \ \ \ \ \ \ \ \ \$this-\/>writeLog(\ \textcolor{stringliteral}{'-\/>\ description:\ '}\ .\ \$this-\/>getDisplayName()\ );}
\DoxyCodeLine{00189\ \ \ \ \ \ \ \ \ \$this-\/>writeLog(\ \textcolor{stringliteral}{'-\/>\ path:\ '}\ .\ \$this-\/>getBinPath()\ );}
\DoxyCodeLine{00190\ \ \ \ \ \ \ \ \ \$this-\/>writeLog(\ \textcolor{stringliteral}{'-\/>\ params:\ '}\ .\ \$this-\/>getParams()\ );}
\DoxyCodeLine{00191\ \ \ \ \ \ \ \ \ \$this-\/>writeLog(\ \textcolor{stringliteral}{'-\/>\ stdout:\ '}\ .\ \$this-\/>getStdout()\ );}
\DoxyCodeLine{00192\ \ \ \ \ \ \ \ \ \$this-\/>writeLog(\ \textcolor{stringliteral}{'-\/>\ stderr:\ '}\ .\ \$this-\/>getStderr()\ );}
\DoxyCodeLine{00193\ \ \ \ \ \ \ \ \ \$this-\/>writeLog(\ \textcolor{stringliteral}{'-\/>\ environment\ extra:\ '}\ .\ \$this-\/>getEnvironmentExtra()\ );}
\DoxyCodeLine{00194\ \ \ \ \ \ \ \ \ \$this-\/>writeLog(\ \textcolor{stringliteral}{'-\/>\ start\_type:\ '}\ .\ (\$this-\/>getStart()\ !=\ \textcolor{keyword}{null}\ ?\ \$this-\/>getStart()\ :\ self::SERVICE\_DEMAND\_START)\ );}
\DoxyCodeLine{00195\ }
\DoxyCodeLine{00196\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Install\ bin}}
\DoxyCodeLine{00197\ \ \ \ \ \ \ \ \ \$exec\ =\ \$this-\/>exec(\ \textcolor{stringliteral}{'install\ '}\ .\ \$this-\/>getName()\ .\ \textcolor{stringliteral}{'\ "{}'}\ .\ \$this-\/>getBinPath()\ .\ \textcolor{charliteral}{'"{}'}\ );}
\DoxyCodeLine{00198\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\ \$exec\ ===\ \textcolor{keyword}{false}\ )\ \{}
\DoxyCodeLine{00199\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00200\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00201\ }
\DoxyCodeLine{00202\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Params}}
\DoxyCodeLine{00203\ \ \ \ \ \ \ \ \ \$exec\ =\ \$this-\/>exec(\ \textcolor{stringliteral}{'set\ '}\ .\ \$this-\/>getName()\ .\ \textcolor{stringliteral}{'\ AppParameters\ "{}'}\ .\ \$this-\/>getParams()\ .\ \textcolor{charliteral}{'"{}'}\ );}
\DoxyCodeLine{00204\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\ \$exec\ ===\ \textcolor{keyword}{false}\ )\ \{}
\DoxyCodeLine{00205\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00206\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00207\ }
\DoxyCodeLine{00208\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ DisplayName}}
\DoxyCodeLine{00209\ \ \ \ \ \ \ \ \ \$exec\ =\ \$this-\/>exec(\ \textcolor{stringliteral}{'set\ '}\ .\ \$this-\/>getName()\ .\ \textcolor{stringliteral}{'\ DisplayName\ "{}'}\ .\ \$this-\/>getDisplayName()\ .\ \textcolor{charliteral}{'"{}'}\ );}
\DoxyCodeLine{00210\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\ \$exec\ ===\ \textcolor{keyword}{false}\ )\ \{}
\DoxyCodeLine{00211\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00212\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00213\ }
\DoxyCodeLine{00214\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Description}}
\DoxyCodeLine{00215\ \ \ \ \ \ \ \ \ \$exec\ =\ \$this-\/>exec(\ \textcolor{stringliteral}{'set\ '}\ .\ \$this-\/>getName()\ .\ \textcolor{stringliteral}{'\ Description\ "{}'}\ .\ \$this-\/>getDisplayName()\ .\ \textcolor{charliteral}{'"{}'}\ );}
\DoxyCodeLine{00216\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\ \$exec\ ===\ \textcolor{keyword}{false}\ )\ \{}
\DoxyCodeLine{00217\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00218\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00219\ }
\DoxyCodeLine{00220\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ No\ AppNoConsole\ to\ fix\ nssm\ problems\ with\ Windows\ 10\ Creators\ update.}}
\DoxyCodeLine{00221\ \ \ \ \ \ \ \ \ \$exec\ =\ \$this-\/>exec(\ \textcolor{stringliteral}{'set\ '}\ .\ \$this-\/>getName()\ .\ \textcolor{stringliteral}{'\ AppNoConsole\ "{}1"{}'}\ );}
\DoxyCodeLine{00222\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\ \$exec\ ===\ \textcolor{keyword}{false}\ )\ \{}
\DoxyCodeLine{00223\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00224\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00225\ }
\DoxyCodeLine{00226\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Start}}
\DoxyCodeLine{00227\ \ \ \ \ \ \ \ \ \$exec\ =\ \$this-\/>exec(\ \textcolor{stringliteral}{'set\ '}\ .\ \$this-\/>getName()\ .\ \textcolor{stringliteral}{'\ Start\ "{}'}\ .\ (\$this-\/>getStart()\ !=\ \textcolor{keyword}{null}\ ?\ \$this-\/>getStart()\ :\ self::SERVICE\_DEMAND\_START)\ .\ \textcolor{charliteral}{'"{}'}\ );}
\DoxyCodeLine{00228\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\ \$exec\ ===\ \textcolor{keyword}{false}\ )\ \{}
\DoxyCodeLine{00229\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00230\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00231\ }
\DoxyCodeLine{00232\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Stdout}}
\DoxyCodeLine{00233\ \ \ \ \ \ \ \ \ \$exec\ =\ \$this-\/>exec(\ \textcolor{stringliteral}{'set\ '}\ .\ \$this-\/>getName()\ .\ \textcolor{stringliteral}{'\ AppStdout\ "{}'}\ .\ \$this-\/>getStdout()\ .\ \textcolor{charliteral}{'"{}'}\ );}
\DoxyCodeLine{00234\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\ \$exec\ ===\ \textcolor{keyword}{false}\ )\ \{}
\DoxyCodeLine{00235\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00236\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00237\ }
\DoxyCodeLine{00238\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Stderr}}
\DoxyCodeLine{00239\ \ \ \ \ \ \ \ \ \$exec\ =\ \$this-\/>exec(\ \textcolor{stringliteral}{'set\ '}\ .\ \$this-\/>getName()\ .\ \textcolor{stringliteral}{'\ AppStderr\ "{}'}\ .\ \$this-\/>getStderr()\ .\ \textcolor{charliteral}{'"{}'}\ );}
\DoxyCodeLine{00240\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\ \$exec\ ===\ \textcolor{keyword}{false}\ )\ \{}
\DoxyCodeLine{00241\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00242\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00243\ }
\DoxyCodeLine{00244\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Environment\ Extra}}
\DoxyCodeLine{00245\ \ \ \ \ \ \ \ \ \$exec\ =\ \$this-\/>exec(\ \textcolor{stringliteral}{'set\ '}\ .\ \$this-\/>getName()\ .\ \textcolor{stringliteral}{'\ AppEnvironmentExtra\ '}\ .\ \$this-\/>getEnvironmentExtra()\ );}
\DoxyCodeLine{00246\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\ \$exec\ ===\ \textcolor{keyword}{false}\ )\ \{}
\DoxyCodeLine{00247\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00248\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00249\ }
\DoxyCodeLine{00250\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\ !\$this-\/>isInstalled()\ )\ \{}
\DoxyCodeLine{00251\ \ \ \ \ \ \ \ \ \ \ \ \ \$this-\/>latestError\ =\ \textcolor{keyword}{null};}
\DoxyCodeLine{00252\ }
\DoxyCodeLine{00253\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00254\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00255\ }
\DoxyCodeLine{00256\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00257\ \ \ \ \ \}}
\DoxyCodeLine{00258\ }
\DoxyCodeLine{00264\ \ \ \ \ \textcolor{keyword}{public}\ \textcolor{keyword}{function}\ \textcolor{keyword}{delete}()}
\DoxyCodeLine{00265\ \ \ \ \ \{}
\DoxyCodeLine{00266\ \ \ \ \ \ \ \ \ \$this-\/>stop();}
\DoxyCodeLine{00267\ }
\DoxyCodeLine{00268\ \ \ \ \ \ \ \ \ \$this-\/>writeLog(\ \textcolor{stringliteral}{'Delete\ service\ '}\ .\ \$this-\/>getName()\ );}
\DoxyCodeLine{00269\ \ \ \ \ \ \ \ \ \$exec\ =\ \$this-\/>exec(\ \textcolor{stringliteral}{'remove\ '}\ .\ \$this-\/>getName()\ .\ \textcolor{stringliteral}{'\ confirm'}\ );}
\DoxyCodeLine{00270\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\ \$exec\ ===\ \textcolor{keyword}{false}\ )\ \{}
\DoxyCodeLine{00271\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00272\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00273\ }
\DoxyCodeLine{00274\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\ \$this-\/>isInstalled()\ )\ \{}
\DoxyCodeLine{00275\ \ \ \ \ \ \ \ \ \ \ \ \ \$this-\/>latestError\ =\ \textcolor{keyword}{null};}
\DoxyCodeLine{00276\ }
\DoxyCodeLine{00277\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00278\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00279\ }
\DoxyCodeLine{00280\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00281\ \ \ \ \ \}}
\DoxyCodeLine{00282\ }
\DoxyCodeLine{00288\ \ \ \ \ \textcolor{keyword}{public}\ \textcolor{keyword}{function}\ start()}
\DoxyCodeLine{00289\ \ \ \ \ \{}
\DoxyCodeLine{00290\ \ \ \ \ \ \ \ \ \$this-\/>writeLog(\ \textcolor{stringliteral}{'Start\ service\ '}\ .\ \$this-\/>getName()\ );}
\DoxyCodeLine{00291\ }
\DoxyCodeLine{00292\ \ \ \ \ \ \ \ \ \$exec\ =\ \$this-\/>exec(\ \textcolor{stringliteral}{'start\ '}\ .\ \$this-\/>getName()\ );}
\DoxyCodeLine{00293\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\ \$exec\ ===\ \textcolor{keyword}{false}\ )\ \{}
\DoxyCodeLine{00294\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00295\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00296\ }
\DoxyCodeLine{00297\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\ !\$this-\/>isRunning()\ )\ \{}
\DoxyCodeLine{00298\ \ \ \ \ \ \ \ \ \ \ \ \ \$this-\/>latestError\ =\ \textcolor{keyword}{null};}
\DoxyCodeLine{00299\ }
\DoxyCodeLine{00300\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00301\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00302\ }
\DoxyCodeLine{00303\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00304\ \ \ \ \ \}}
\DoxyCodeLine{00305\ }
\DoxyCodeLine{00311\ \ \ \ \ \textcolor{keyword}{public}\ \textcolor{keyword}{function}\ stop()}
\DoxyCodeLine{00312\ \ \ \ \ \{}
\DoxyCodeLine{00313\ \ \ \ \ \ \ \ \ \$this-\/>writeLog(\ \textcolor{stringliteral}{'Stop\ service\ '}\ .\ \$this-\/>getName()\ );}
\DoxyCodeLine{00314\ }
\DoxyCodeLine{00315\ \ \ \ \ \ \ \ \ \$exec\ =\ \$this-\/>exec(\ \textcolor{stringliteral}{'stop\ '}\ .\ \$this-\/>getName()\ );}
\DoxyCodeLine{00316\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\ \$exec\ ===\ \textcolor{keyword}{false}\ )\ \{}
\DoxyCodeLine{00317\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00318\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00319\ }
\DoxyCodeLine{00320\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\ !\$this-\/>isStopped()\ )\ \{}
\DoxyCodeLine{00321\ \ \ \ \ \ \ \ \ \ \ \ \ \$this-\/>latestError\ =\ \textcolor{keyword}{null};}
\DoxyCodeLine{00322\ }
\DoxyCodeLine{00323\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00324\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00325\ }
\DoxyCodeLine{00326\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00327\ \ \ \ \ \}}
\DoxyCodeLine{00328\ }
\DoxyCodeLine{00334\ \ \ \ \ \textcolor{keyword}{public}\ \textcolor{keyword}{function}\ restart()}
\DoxyCodeLine{00335\ \ \ \ \ \{}
\DoxyCodeLine{00336\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\ \$this-\/>stop()\ )\ \{}
\DoxyCodeLine{00337\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \$this-\/>start();}
\DoxyCodeLine{00338\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00339\ }
\DoxyCodeLine{00340\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00341\ \ \ \ \ \}}
\DoxyCodeLine{00342\ }
\DoxyCodeLine{00348\ \ \ \ \ \textcolor{keyword}{public}\ \textcolor{keyword}{function}\ infos()}
\DoxyCodeLine{00349\ \ \ \ \ \{}
\DoxyCodeLine{00350\ \ \ \ \ \ \ \ \ global\ \$bearsamppRegistry;}
\DoxyCodeLine{00351\ }
\DoxyCodeLine{00352\ \ \ \ \ \ \ \ \ \$infos\ =\ Vbs::getServiceInfos(\ \$this-\/>getName()\ );}
\DoxyCodeLine{00353\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\ \$infos\ ===\ \textcolor{keyword}{false}\ )\ \{}
\DoxyCodeLine{00354\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00355\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00356\ }
\DoxyCodeLine{00357\ \ \ \ \ \ \ \ \ \$infosNssm\ =\ array();}
\DoxyCodeLine{00358\ \ \ \ \ \ \ \ \ \$infosKeys\ =\ array(}
\DoxyCodeLine{00359\ \ \ \ \ \ \ \ \ \ \ \ \ self::INFO\_APPLICATION,}
\DoxyCodeLine{00360\ \ \ \ \ \ \ \ \ \ \ \ \ self::INFO\_APP\_PARAMETERS,}
\DoxyCodeLine{00361\ \ \ \ \ \ \ \ \ );}
\DoxyCodeLine{00362\ }
\DoxyCodeLine{00363\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{foreach}\ (\ \$infosKeys\ as\ \$infoKey\ )\ \{}
\DoxyCodeLine{00364\ \ \ \ \ \ \ \ \ \ \ \ \ \$value\ \ =\ \textcolor{keyword}{null};}
\DoxyCodeLine{00365\ \ \ \ \ \ \ \ \ \ \ \ \ \$exists\ =\ \$bearsamppRegistry-\/>exists(}
\DoxyCodeLine{00366\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Registry::HKEY\_LOCAL\_MACHINE,}
\DoxyCodeLine{00367\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'SYSTEM\(\backslash\)CurrentControlSet\(\backslash\)Services\(\backslash\)\(\backslash\)'}\ .\ \$this-\/>getName()\ .\ \textcolor{stringliteral}{'\(\backslash\)Parameters'},}
\DoxyCodeLine{00368\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$infoKey}
\DoxyCodeLine{00369\ \ \ \ \ \ \ \ \ \ \ \ \ );}
\DoxyCodeLine{00370\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\ \$exists\ )\ \{}
\DoxyCodeLine{00371\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$value\ =\ \$bearsamppRegistry-\/>getValue(}
\DoxyCodeLine{00372\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Registry::HKEY\_LOCAL\_MACHINE,}
\DoxyCodeLine{00373\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'SYSTEM\(\backslash\)CurrentControlSet\(\backslash\)Services\(\backslash\)\(\backslash\)'}\ .\ \$this-\/>getName()\ .\ \textcolor{stringliteral}{'\(\backslash\)Parameters'},}
\DoxyCodeLine{00374\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$infoKey}
\DoxyCodeLine{00375\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ );}
\DoxyCodeLine{00376\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00377\ \ \ \ \ \ \ \ \ \ \ \ \ \$infosNssm[\$infoKey]\ =\ \$value;}
\DoxyCodeLine{00378\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00379\ }
\DoxyCodeLine{00380\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\ !isset(\ \$infosNssm[self::INFO\_APPLICATION]\ )\ )\ \{}
\DoxyCodeLine{00381\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \$infos;}
\DoxyCodeLine{00382\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00383\ }
\DoxyCodeLine{00384\ \ \ \ \ \ \ \ \ \$infos[Win32Service::VBS\_PATH\_NAME]\ =\ \$infosNssm[Nssm::INFO\_APPLICATION]\ .\ \textcolor{charliteral}{'\ '}\ .\ \$infosNssm[Nssm::INFO\_APP\_PARAMETERS];}
\DoxyCodeLine{00385\ }
\DoxyCodeLine{00386\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \$infos;}
\DoxyCodeLine{00387\ \ \ \ \ \}}
\DoxyCodeLine{00388\ }
\DoxyCodeLine{00394\ \ \ \ \ \textcolor{keyword}{public}\ \textcolor{keyword}{function}\ isInstalled()}
\DoxyCodeLine{00395\ \ \ \ \ \{}
\DoxyCodeLine{00396\ \ \ \ \ \ \ \ \ \$status\ =\ \$this-\/>status();}
\DoxyCodeLine{00397\ \ \ \ \ \ \ \ \ \$this-\/>writeLog(\ \textcolor{stringliteral}{'isInstalled\ '}\ .\ \$this-\/>getName()\ .\ \textcolor{stringliteral}{':\ '}\ .\ (\$status\ !=\ self::STATUS\_NA\ ?\ \textcolor{stringliteral}{'YES'}\ :\ \textcolor{stringliteral}{'NO'})\ .\ \textcolor{stringliteral}{'\ (status:\ '}\ .\ \$status\ .\ \textcolor{charliteral}{')'}\ );}
\DoxyCodeLine{00398\ }
\DoxyCodeLine{00399\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \$status\ !=\ self::STATUS\_NA;}
\DoxyCodeLine{00400\ \ \ \ \ \}}
\DoxyCodeLine{00401\ }
\DoxyCodeLine{00407\ \ \ \ \ \textcolor{keyword}{public}\ \textcolor{keyword}{function}\ isRunning()}
\DoxyCodeLine{00408\ \ \ \ \ \{}
\DoxyCodeLine{00409\ \ \ \ \ \ \ \ \ \$status\ =\ \$this-\/>status();}
\DoxyCodeLine{00410\ \ \ \ \ \ \ \ \ \$this-\/>writeLog(\ \textcolor{stringliteral}{'isRunning\ '}\ .\ \$this-\/>getName()\ .\ \textcolor{stringliteral}{':\ '}\ .\ (\$status\ ==\ self::STATUS\_RUNNING\ ?\ \textcolor{stringliteral}{'YES'}\ :\ \textcolor{stringliteral}{'NO'})\ .\ \textcolor{stringliteral}{'\ (status:\ '}\ .\ \$status\ .\ \textcolor{charliteral}{')'}\ );}
\DoxyCodeLine{00411\ }
\DoxyCodeLine{00412\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \$status\ ==\ self::STATUS\_RUNNING;}
\DoxyCodeLine{00413\ \ \ \ \ \}}
\DoxyCodeLine{00414\ }
\DoxyCodeLine{00420\ \ \ \ \ \textcolor{keyword}{public}\ \textcolor{keyword}{function}\ isStopped()}
\DoxyCodeLine{00421\ \ \ \ \ \{}
\DoxyCodeLine{00422\ \ \ \ \ \ \ \ \ \$status\ =\ \$this-\/>status();}
\DoxyCodeLine{00423\ \ \ \ \ \ \ \ \ \$this-\/>writeLog(\ \textcolor{stringliteral}{'isStopped\ '}\ .\ \$this-\/>getName()\ .\ \textcolor{stringliteral}{':\ '}\ .\ (\$status\ ==\ self::STATUS\_STOPPED\ ?\ \textcolor{stringliteral}{'YES'}\ :\ \textcolor{stringliteral}{'NO'})\ .\ \textcolor{stringliteral}{'\ (status:\ '}\ .\ \$status\ .\ \textcolor{charliteral}{')'}\ );}
\DoxyCodeLine{00424\ }
\DoxyCodeLine{00425\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \$status\ ==\ self::STATUS\_STOPPED;}
\DoxyCodeLine{00426\ \ \ \ \ \}}
\DoxyCodeLine{00427\ }
\DoxyCodeLine{00433\ \ \ \ \ \textcolor{keyword}{public}\ \textcolor{keyword}{function}\ isPaused()}
\DoxyCodeLine{00434\ \ \ \ \ \{}
\DoxyCodeLine{00435\ \ \ \ \ \ \ \ \ \$status\ =\ \$this-\/>status();}
\DoxyCodeLine{00436\ \ \ \ \ \ \ \ \ \$this-\/>writeLog(\ \textcolor{stringliteral}{'isPaused\ '}\ .\ \$this-\/>getName()\ .\ \textcolor{stringliteral}{':\ '}\ .\ (\$status\ ==\ self::STATUS\_PAUSED\ ?\ \textcolor{stringliteral}{'YES'}\ :\ \textcolor{stringliteral}{'NO'})\ .\ \textcolor{stringliteral}{'\ (status:\ '}\ .\ \$status\ .\ \textcolor{charliteral}{')'}\ );}
\DoxyCodeLine{00437\ }
\DoxyCodeLine{00438\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \$status\ ==\ self::STATUS\_PAUSED;}
\DoxyCodeLine{00439\ \ \ \ \ \}}
\DoxyCodeLine{00440\ }
\DoxyCodeLine{00448\ \ \ \ \ \textcolor{keyword}{public}\ \textcolor{keyword}{function}\ isPending(\$status)}
\DoxyCodeLine{00449\ \ \ \ \ \{}
\DoxyCodeLine{00450\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \$status\ ==\ self::STATUS\_START\_PENDING\ ||\ \$status\ ==\ self::STATUS\_STOP\_PENDING}
\DoxyCodeLine{00451\ \ \ \ \ \ \ \ \ \ \ \ \ ||\ \$status\ ==\ self::STATUS\_CONTINUE\_PENDING\ ||\ \$status\ ==\ self::STATUS\_PAUSE\_PENDING;}
\DoxyCodeLine{00452\ \ \ \ \ \}}
\DoxyCodeLine{00453\ }
\DoxyCodeLine{00461\ \ \ \ \ \textcolor{keyword}{private}\ \textcolor{keyword}{function}\ getServiceStatusDesc(\$status)}
\DoxyCodeLine{00462\ \ \ \ \ \{}
\DoxyCodeLine{00463\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{switch}\ (\ \$status\ )\ \{}
\DoxyCodeLine{00464\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ self::STATUS\_CONTINUE\_PENDING:}
\DoxyCodeLine{00465\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{'The\ service\ continue\ is\ pending.'};}
\DoxyCodeLine{00466\ }
\DoxyCodeLine{00467\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ self::STATUS\_PAUSE\_PENDING:}
\DoxyCodeLine{00468\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{'The\ service\ pause\ is\ pending.'};}
\DoxyCodeLine{00469\ }
\DoxyCodeLine{00470\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ self::STATUS\_PAUSED:}
\DoxyCodeLine{00471\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{'The\ service\ is\ paused.'};}
\DoxyCodeLine{00472\ }
\DoxyCodeLine{00473\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ self::STATUS\_RUNNING:}
\DoxyCodeLine{00474\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{'The\ service\ is\ running.'};}
\DoxyCodeLine{00475\ }
\DoxyCodeLine{00476\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ self::STATUS\_START\_PENDING:}
\DoxyCodeLine{00477\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{'The\ service\ is\ starting.'};}
\DoxyCodeLine{00478\ }
\DoxyCodeLine{00479\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ self::STATUS\_STOP\_PENDING:}
\DoxyCodeLine{00480\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{'The\ service\ is\ stopping.'};}
\DoxyCodeLine{00481\ }
\DoxyCodeLine{00482\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ self::STATUS\_STOPPED:}
\DoxyCodeLine{00483\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{'The\ service\ is\ not\ running.'};}
\DoxyCodeLine{00484\ }
\DoxyCodeLine{00485\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ self::STATUS\_NA:}
\DoxyCodeLine{00486\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{'Cannot\ retrieve\ service\ status.'};}
\DoxyCodeLine{00487\ }
\DoxyCodeLine{00488\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{00489\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{null};}
\DoxyCodeLine{00490\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00491\ \ \ \ \ \}}
\DoxyCodeLine{00492\ }
\DoxyCodeLine{00498\ \ \ \ \ \textcolor{keyword}{public}\ \textcolor{keyword}{function}\ getName()}
\DoxyCodeLine{00499\ \ \ \ \ \{}
\DoxyCodeLine{00500\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \$this-\/>name;}
\DoxyCodeLine{00501\ \ \ \ \ \}}
\DoxyCodeLine{00502\ }
\DoxyCodeLine{00508\ \ \ \ \ \textcolor{keyword}{public}\ \textcolor{keyword}{function}\ setName(\$name)}
\DoxyCodeLine{00509\ \ \ \ \ \{}
\DoxyCodeLine{00510\ \ \ \ \ \ \ \ \ \$this-\/>name\ =\ \$name;}
\DoxyCodeLine{00511\ \ \ \ \ \}}
\DoxyCodeLine{00512\ }
\DoxyCodeLine{00518\ \ \ \ \ \textcolor{keyword}{public}\ \textcolor{keyword}{function}\ getDisplayName()}
\DoxyCodeLine{00519\ \ \ \ \ \{}
\DoxyCodeLine{00520\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \$this-\/>displayName;}
\DoxyCodeLine{00521\ \ \ \ \ \}}
\DoxyCodeLine{00522\ }
\DoxyCodeLine{00528\ \ \ \ \ \textcolor{keyword}{public}\ \textcolor{keyword}{function}\ setDisplayName(\$displayName)}
\DoxyCodeLine{00529\ \ \ \ \ \{}
\DoxyCodeLine{00530\ \ \ \ \ \ \ \ \ \$this-\/>displayName\ =\ \$displayName;}
\DoxyCodeLine{00531\ \ \ \ \ \}}
\DoxyCodeLine{00532\ }
\DoxyCodeLine{00538\ \ \ \ \ \textcolor{keyword}{public}\ \textcolor{keyword}{function}\ getBinPath()}
\DoxyCodeLine{00539\ \ \ \ \ \{}
\DoxyCodeLine{00540\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \$this-\/>binPath;}
\DoxyCodeLine{00541\ \ \ \ \ \}}
\DoxyCodeLine{00542\ }
\DoxyCodeLine{00548\ \ \ \ \ \textcolor{keyword}{public}\ \textcolor{keyword}{function}\ setBinPath(\$binPath)}
\DoxyCodeLine{00549\ \ \ \ \ \{}
\DoxyCodeLine{00550\ \ \ \ \ \ \ \ \ \$this-\/>binPath\ =\ str\_replace(\ \textcolor{charliteral}{'"{}'},\ \textcolor{stringliteral}{''},\ Util::formatWindowsPath(\ \$binPath\ )\ );}
\DoxyCodeLine{00551\ \ \ \ \ \}}
\DoxyCodeLine{00552\ }
\DoxyCodeLine{00558\ \ \ \ \ \textcolor{keyword}{public}\ \textcolor{keyword}{function}\ getParams()}
\DoxyCodeLine{00559\ \ \ \ \ \{}
\DoxyCodeLine{00560\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \$this-\/>params;}
\DoxyCodeLine{00561\ \ \ \ \ \}}
\DoxyCodeLine{00562\ }
\DoxyCodeLine{00568\ \ \ \ \ \textcolor{keyword}{public}\ \textcolor{keyword}{function}\ setParams(\$params)}
\DoxyCodeLine{00569\ \ \ \ \ \{}
\DoxyCodeLine{00570\ \ \ \ \ \ \ \ \ \$this-\/>params\ =\ \$params;}
\DoxyCodeLine{00571\ \ \ \ \ \}}
\DoxyCodeLine{00572\ }
\DoxyCodeLine{00578\ \ \ \ \ \textcolor{keyword}{public}\ \textcolor{keyword}{function}\ getStart()}
\DoxyCodeLine{00579\ \ \ \ \ \{}
\DoxyCodeLine{00580\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \$this-\/>start;}
\DoxyCodeLine{00581\ \ \ \ \ \}}
\DoxyCodeLine{00582\ }
\DoxyCodeLine{00588\ \ \ \ \ \textcolor{keyword}{public}\ \textcolor{keyword}{function}\ setStart(\$start)}
\DoxyCodeLine{00589\ \ \ \ \ \{}
\DoxyCodeLine{00590\ \ \ \ \ \ \ \ \ \$this-\/>start\ =\ \$start;}
\DoxyCodeLine{00591\ \ \ \ \ \}}
\DoxyCodeLine{00592\ }
\DoxyCodeLine{00598\ \ \ \ \ \textcolor{keyword}{public}\ \textcolor{keyword}{function}\ getStdout()}
\DoxyCodeLine{00599\ \ \ \ \ \{}
\DoxyCodeLine{00600\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \$this-\/>stdout;}
\DoxyCodeLine{00601\ \ \ \ \ \}}
\DoxyCodeLine{00602\ }
\DoxyCodeLine{00608\ \ \ \ \ \textcolor{keyword}{public}\ \textcolor{keyword}{function}\ setStdout(\$stdout)}
\DoxyCodeLine{00609\ \ \ \ \ \{}
\DoxyCodeLine{00610\ \ \ \ \ \ \ \ \ \$this-\/>stdout\ =\ \$stdout;}
\DoxyCodeLine{00611\ \ \ \ \ \}}
\DoxyCodeLine{00612\ }
\DoxyCodeLine{00618\ \ \ \ \ \textcolor{keyword}{public}\ \textcolor{keyword}{function}\ getStderr()}
\DoxyCodeLine{00619\ \ \ \ \ \{}
\DoxyCodeLine{00620\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \$this-\/>stderr;}
\DoxyCodeLine{00621\ \ \ \ \ \}}
\DoxyCodeLine{00622\ }
\DoxyCodeLine{00628\ \ \ \ \ \textcolor{keyword}{public}\ \textcolor{keyword}{function}\ setStderr(\$stderr)}
\DoxyCodeLine{00629\ \ \ \ \ \{}
\DoxyCodeLine{00630\ \ \ \ \ \ \ \ \ \$this-\/>stderr\ =\ \$stderr;}
\DoxyCodeLine{00631\ \ \ \ \ \}}
\DoxyCodeLine{00632\ }
\DoxyCodeLine{00638\ \ \ \ \ \textcolor{keyword}{public}\ \textcolor{keyword}{function}\ getEnvironmentExtra()}
\DoxyCodeLine{00639\ \ \ \ \ \{}
\DoxyCodeLine{00640\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \$this-\/>environmentExtra;}
\DoxyCodeLine{00641\ \ \ \ \ \}}
\DoxyCodeLine{00642\ }
\DoxyCodeLine{00648\ \ \ \ \ \textcolor{keyword}{public}\ \textcolor{keyword}{function}\ setEnvironmentExtra(\$environmentExtra)}
\DoxyCodeLine{00649\ \ \ \ \ \{}
\DoxyCodeLine{00650\ \ \ \ \ \ \ \ \ \$this-\/>environmentExtra\ =\ Util::formatWindowsPath(\ \$environmentExtra\ );}
\DoxyCodeLine{00651\ \ \ \ \ \}}
\DoxyCodeLine{00652\ }
\DoxyCodeLine{00658\ \ \ \ \ \textcolor{keyword}{public}\ \textcolor{keyword}{function}\ getLatestStatus()}
\DoxyCodeLine{00659\ \ \ \ \ \{}
\DoxyCodeLine{00660\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \$this-\/>latestStatus;}
\DoxyCodeLine{00661\ \ \ \ \ \}}
\DoxyCodeLine{00662\ }
\DoxyCodeLine{00668\ \ \ \ \ \textcolor{keyword}{public}\ \textcolor{keyword}{function}\ getLatestError()}
\DoxyCodeLine{00669\ \ \ \ \ \{}
\DoxyCodeLine{00670\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \$this-\/>latestError;}
\DoxyCodeLine{00671\ \ \ \ \ \}}
\DoxyCodeLine{00672\ }
\DoxyCodeLine{00678\ \ \ \ \ \textcolor{keyword}{public}\ \textcolor{keyword}{function}\ getError()}
\DoxyCodeLine{00679\ \ \ \ \ \{}
\DoxyCodeLine{00680\ \ \ \ \ \ \ \ \ global\ \$bearsamppLang;}
\DoxyCodeLine{00681\ }
\DoxyCodeLine{00682\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\ !empty(\ \$this-\/>latestError\ )\ )\ \{}
\DoxyCodeLine{00683\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \$bearsamppLang-\/>getValue(\ Lang::ERROR\ )\ .\ \textcolor{charliteral}{'\ '}\ .\ \$this-\/>latestError;}
\DoxyCodeLine{00684\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00685\ \ \ \ \ \ \ \ \ elseif\ (\ \$this-\/>latestStatus\ !=\ self::STATUS\_NA\ )\ \{}
\DoxyCodeLine{00686\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \$bearsamppLang-\/>getValue(\ Lang::STATUS\ )\ .\ \textcolor{charliteral}{'\ '}\ .\ \$this-\/>latestStatus\ .\ \textcolor{stringliteral}{'\ :\ '}\ .\ \$this-\/>getWin32ServiceStatusDesc(\ \$this-\/>latestStatus\ );}
\DoxyCodeLine{00687\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00688\ }
\DoxyCodeLine{00689\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{null};}
\DoxyCodeLine{00690\ \ \ \ \ \}}
\DoxyCodeLine{00691\ \}}

\end{DoxyCode}
